{
	"name": "DF_BALD0002_CP_PCR_RPT",
	"properties": {
		"description": "Job creation:05-06-2022\nJob name: DF_BALD0002_CP_PCR_RPT\nCreated By: Varaprasad",
		"folder": {
			"name": "PGMP/CP Summary & Custom Field audit"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"linkedService": {
						"referenceName": "ls_pgmp_rfs_db",
						"type": "LinkedServiceReference"
					},
					"name": "getSourceDataforPCR"
				}
			],
			"sinks": [
				{
					"linkedService": {
						"referenceName": "ls_pgmp_rfs_db",
						"type": "LinkedServiceReference"
					},
					"name": "upsertTable"
				}
			],
			"transformations": [
				{
					"name": "upsertRows"
				}
			],
			"scriptLines": [
				"source(output(",
				"          CNTRCT_DIM_UID as integer,",
				"          CNTRCT_NM as string,",
				"          GLBL_BUY_GRP_ID as string,",
				"          UNIQUE_ID as integer,",
				"          DISPLAYED_ID as string,",
				"          PARENT_UNIQUE_ID as integer,",
				"          PARENT_VISIBLE_ID as string,",
				"          PARENT_TITLE as string,",
				"          CLIENT_REFERENCE_NUM as string,",
				"          PURCHASE_ORDER as string,",
				"          WKFLW_DEF_ID as string,",
				"          INIT_WKFLW_DEF_ID_DESCR as string,",
				"          PROC_TITLE as string,",
				"          PROC_DESC as string,",
				"          CURR_WRKFLW_NM as string,",
				"          WKFLW_STEP_DEF_ID as string,",
				"          WKFLW_STEP_SEQ_NUM as integer,",
				"          WKFLW_STEP_DESC as string,",
				"          STATE_DESC as string,",
				"          STATUS_DESC as string,",
				"          AUDIENCE as string,",
				"          CONDITION as string,",
				"          REGION as string,",
				"          HOLD_STATUS as string,",
				"          ON_HOLD_DT as date,",
				"          HOLD_REASON as string,",
				"          HOLD_OR_WITHDRAW_EXPLANATION as string,",
				"          CREATED_DATE as timestamp,",
				"          LAST_UPDATED as timestamp,",
				"          RQST_RCVD_BY_IBM_DATE as date,",
				"          ACKNOWLEDGED_DATE as date,",
				"          RQST_QUALIFIED_DATE as date,",
				"          LETTER_AUTH_SIGNATURE_DT as date,",
				"          PLANNED_RQMTS_APPROVAL_DATE as date,",
				"          RQMTS_REWORK_RQSTD_DATE as date,",
				"          RQMTS_DEFINITION_COMPLETE_DT as date,",
				"          RQMTS_AGREED_DATE as date,",
				"          CLIENT_REJECT_RQMTS_DATE as date,",
				"          PLAN_SLTN_CMPLTD_DT as date,",
				"          RVSD_PLAN_SLTN_CMPLTD_DT as date,",
				"          TCHNLGY_DLVR_ASSESSMT_DT as date,",
				"          SOLUTION_COMPLETED_DATE as date,",
				"          SLTN_APPRVL_RQRD_DT as date,",
				"          CLNT_ACCPTD_SLTN_DT as date,",
				"          CLNT_REJCT_SLTN_DT as date,",
				"          SLTN_PKGNG_DT as date,",
				"          SOLTN_PACKAGE_VALIDATE_DT as date,",
				"          PRICING_COMPLETED_DT as date,",
				"          PRPSL_BSLN_ASSESSMT_DT as date,",
				"          CNTRCT_BSLN_RVW_DT as date,",
				"          CLIENT_PRPSL_REQUESTED_DATE as date,",
				"          CLIENT_REVISED_PRPSL_REQUESTED_DATE as date,",
				"          PLANNED_PRPSL_DATE as date,",
				"          REVISED_PLANNED_PRPSL_DATE as date,",
				"          CLIENT_RQSTD_IMPL_START_DT as date,",
				"          DUE_DT as date,",
				"          PROPOSAL_RESPONSE_REQUESTED_DATE as date,",
				"          PROPOSAL_EXPIRE_DATE as date,",
				"          PRPSL_SENT_TO_CLNT_DT as date,",
				"          PROPOSAL_ACCEPTED_DATE as date,",
				"          PROPOSAL_REJECTED_DATE as date,",
				"          COMPLETION_DATE as date,",
				"          CLNT_SIGNTUR_RCVD_DT as date,",
				"          IBM_SIGNTUR_RCVD_DT as date,",
				"          CLIENT_REQ_IMPLMNT_COMPLETE_DATE as date,",
				"          CLIENT_REQ_IMPLMNT_START_DATE as date,",
				"          ENGAGEMENT_HANDOFF_DATE as date,",
				"          PLANNED_IMPLMNT_COMPLETED_DATE as date,",
				"          REVISED_PLANNED_IMPLMNT_COMPLETED_DATE as date,",
				"          WITHDRWN_DT as date,",
				"          CMPLTD_RSN_TXT as string,",
				"          REJECT_REWORK_REASON as string,",
				"          REJECT_REWORK_SOURCE as string,",
				"          REJECT_REWORK_EXPLANATION as string,",
				"          LAG_DAYS_NUM as integer,",
				"          CLIENT_AFFECTED_AREA as string,",
				"          CLIENT_ACCNTG_CD as string,",
				"          AGREEMENT_REF_DETAILS as string,",
				"          ORIGINATING_ORG as string,",
				"          UNSOLICITED_REQUEST as string,",
				"          CONTRACT_CHANGE_REQUIRED as string,",
				"          OATS_RECORD_NEEDED as string,",
				"          NON_STD_TERMS_CONDITIONS as string,",
				"          TRAVEL_EXPENSES_INVOICED as string,",
				"          TERMINATION_CHARGES as string,",
				"          ANNUAL_RENEWAL_MONTH as string,",
				"          SERVICE_PROVIDER_ORG as string,",
				"          PREDEFINED_SRVCS as string,",
				"          COUNTRY as string,",
				"          SIEBEL_OPP_NUM as string,",
				"          BTT_NUM as integer,",
				"          COMPLEXITY as string,",
				"          ESTIMATED_SOLUTION_HOURS as integer,",
				"          CLAIM_ACCOUNT_CODE as string,",
				"          EST_IMPLEMENTATION_HOURS as integer,",
				"          PERSONNEL_CHANGES as string,",
				"          SERVER_COMPONENT as string,",
				"          STORAGE_COMPONENT as string,",
				"          HARDWARE_COMPONENT as string,",
				"          SOFTWARE_COMPONENT as string,",
				"          LOCAL_CURRENCY as string,",
				"          ALT_CURRENCY as string,",
				"          ESTIMATED_OTC_LOCAL_CURR as decimal(38,2),",
				"          ESTIMATED_TCV_LOCAL_CURR as decimal(38,2),",
				"          ESTIMATED_PRPSL_PROD_COST_LOCAL_CURR as decimal(38,2),",
				"          ACTUAL_PRPSL_PROD_COST_LOCAL_CURR as decimal(38,2),",
				"          NON_RECURRING_COST_LOCAL_CURR as decimal(38,2),",
				"          NON_RECURRING_COST_ALT_CURR as decimal(38,2),",
				"          MNTHLY_RECURRING_COST_LOCAL_CURR as decimal(38,2),",
				"          MNTHLY_RECURRING_COST_ALT_CURR as decimal(38,2),",
				"          TOTAL_CNTRCT_COST_LOCAL_CURR as decimal(38,2),",
				"          TOTAL_CNTRCT_COST_ALT_CURR as decimal(38,2),",
				"          NON_RECURRING_PRICE_LOCAL_CURR as decimal(38,2),",
				"          NON_RECURRING_PRICE_ALT_CURR as decimal(38,2),",
				"          MNTHLY_RECURRING_CHARGES_LOCAL_CURR as decimal(38,2),",
				"          MNTHLY_RECURRING_CHARGES_ALT_CURR as decimal(38,2),",
				"          TOTAL_CNTRCT_PRICE_LOCAL_CURR as decimal(38,2),",
				"          TOTAL_CNTRCT_PRICE_ALT_CURR as decimal(38,2),",
				"          CLIENT_FOCAL_POINT as string,",
				"          IBM_RFS_MANAGER as string,",
				"          REQUIREMENTS_TEAM_LEAD as string,",
				"          CLIENT_CATALOG_ONLY_REQUESTOR as string,",
				"          CLIENT_CATALOG_ONLY_APPROVER as string,",
				"          CLIENT_CTLG_ONLY_BUDGET_APPROVER as string,",
				"          CLIENT_CTLG_ONLY_FOCAL_POINT as string,",
				"          SRC_SYS_CD as string,",
				"          LEGACY_UNIQUE_ID as string,",
				"          LEGACY_DISPLAYED_ID as string,",
				"          LATEST_IBM_ONLY_NOTE as string,",
				"          LATEST_IBM_AND_CLIENT_NOTE as string,",
				"          L30_OFFERING_1 as string,",
				"          L30_OFFERING_2 as string,",
				"          L30_OFFERING_3 as string,",
				"          PRIOR_TOTAL_CNTRCT_PRICE_AMT as decimal(38,2),",
				"          PRPSL_CHG_RSN_TXT as string,",
				"          PRPSL_CHG_EXPLNN_TXT as string,",
				"          IMPLMTN_CHG_RSN_TXT as string,",
				"          IMPLMTN_CHG_EXPLNN_TXT as string,",
				"          PRPSL_LATE_RSN_TXT as string,",
				"          PRPSL_LATE_EXPLNN_TXT as string,",
				"          IMPLMTN_LATE_RSN_TXT as string,",
				"          IMPLMTN_LATE_EXPLNN_TXT as string,",
				"          CLIENT_APPROVER as string,",
				"          CLIENT_BUDGET_APPROVER as string,",
				"          IBM_ONLY_TEXT_1 as string,",
				"          IBM_ONLY_TEXT_2 as string,",
				"          IBM_ONLY_TEXT_3 as string,",
				"          IBM_ONLY_TEXT_4 as string,",
				"          IBM_ONLY_TEXT_5 as string,",
				"          IBM_ONLY_TEXT_6 as string,",
				"          IBM_ONLY_TEXT_7 as string,",
				"          IBM_ONLY_TEXT_8 as string,",
				"          IBM_ONLY_TEXT_9 as string,",
				"          IBM_ONLY_TEXT_10 as string,",
				"          IBM_ONLY_TEXT_11 as string,",
				"          IBM_ONLY_TEXT_12 as string,",
				"          IBM_ONLY_TEXT_13 as string,",
				"          IBM_ONLY_TEXT_14 as string,",
				"          IBM_ONLY_TEXT_15 as string,",
				"          IBM_ONLY_TEXT_16 as string,",
				"          IBM_ONLY_TEXT_17 as string,",
				"          IBM_ONLY_TEXT_18 as string,",
				"          IBM_ONLY_TEXT_19 as string,",
				"          IBM_ONLY_TEXT_20 as string,",
				"          IBM_ONLY_TEXT_21 as string,",
				"          IBM_ONLY_TEXT_22 as string,",
				"          IBM_ONLY_TEXT_23 as string,",
				"          IBM_ONLY_TEXT_24 as string,",
				"          IBM_ONLY_TEXT_25 as string,",
				"          IBM_ONLY_DATE_1 as date,",
				"          IBM_ONLY_DATE_2 as date,",
				"          IBM_ONLY_DATE_3 as date,",
				"          IBM_ONLY_DATE_4 as date,",
				"          IBM_ONLY_DATE_5 as date,",
				"          IBM_ONLY_DATE_6 as date,",
				"          IBM_ONLY_DATE_7 as date,",
				"          IBM_ONLY_DATE_8 as date,",
				"          IBM_ONLY_DATE_9 as date,",
				"          IBM_ONLY_DATE_10 as date,",
				"          IBM_ONLY_DATE_11 as date,",
				"          IBM_ONLY_DATE_12 as date,",
				"          IBM_ONLY_DATE_13 as date,",
				"          IBM_ONLY_DATE_14 as date,",
				"          IBM_ONLY_DATE_15 as date,",
				"          PUBLIC_TEXT_1 as string,",
				"          PUBLIC_TEXT_2 as string,",
				"          PUBLIC_TEXT_3 as string,",
				"          PUBLIC_TEXT_4 as string,",
				"          PUBLIC_TEXT_5 as string,",
				"          PUBLIC_TEXT_6 as string,",
				"          PUBLIC_TEXT_7 as string,",
				"          PUBLIC_TEXT_8 as string,",
				"          PUBLIC_TEXT_9 as string,",
				"          PUBLIC_TEXT_10 as string,",
				"          PUBLIC_TEXT_11 as string,",
				"          PUBLIC_TEXT_12 as string,",
				"          PUBLIC_TEXT_13 as string,",
				"          PUBLIC_TEXT_14 as string,",
				"          PUBLIC_TEXT_15 as string,",
				"          PUBLIC_TEXT_16 as string,",
				"          PUBLIC_TEXT_17 as string,",
				"          PUBLIC_TEXT_18 as string,",
				"          PUBLIC_TEXT_19 as string,",
				"          PUBLIC_TEXT_20 as string,",
				"          PUBLIC_TEXT_21 as string,",
				"          PUBLIC_TEXT_22 as string,",
				"          PUBLIC_TEXT_23 as string,",
				"          PUBLIC_TEXT_24 as string,",
				"          PUBLIC_TEXT_25 as string,",
				"          PUBLIC_TEXT_26 as string,",
				"          PUBLIC_TEXT_27 as string,",
				"          PUBLIC_TEXT_28 as string,",
				"          PUBLIC_TEXT_29 as string,",
				"          PUBLIC_TEXT_30 as string,",
				"          PUBLIC_TEXT_31 as string,",
				"          PUBLIC_TEXT_32 as string,",
				"          PUBLIC_TEXT_33 as string,",
				"          PUBLIC_TEXT_34 as string,",
				"          PUBLIC_TEXT_35 as string,",
				"          PUBLIC_DATE_1 as date,",
				"          PUBLIC_DATE_2 as date,",
				"          PUBLIC_DATE_3 as date,",
				"          PUBLIC_DATE_4 as date,",
				"          PUBLIC_DATE_5 as date,",
				"          PUBLIC_DATE_6 as date,",
				"          PUBLIC_DATE_7 as date,",
				"          PUBLIC_DATE_8 as date,",
				"          PUBLIC_DATE_9 as date,",
				"          PUBLIC_DATE_10 as date,",
				"          PUBLIC_DATE_11 as date,",
				"          PUBLIC_DATE_12 as date,",
				"          PUBLIC_DATE_13 as date,",
				"          PUBLIC_DATE_14 as date,",
				"          PUBLIC_DATE_15 as date,",
				"          STATE_OF_ORGANIZATION as string,",
				"          SCTR_NM as string,",
				"          ERO_CHCKD_DT as date,",
				"          EA_CHCKD_DT as date,",
				"          CE_CHCKD_DT as date,",
				"          EXPORT_REG as string,",
				"          ENVMNTL_AFF as string,",
				"          CMPLNCE_ENGG as string,",
				"          CLIENT_UNIT as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     format: 'query',",
				"     store: 'sqlserver',",
				"     query: 'SELECT \\nC.CNTRCT_DIM_UID, C.CNTRCT_NM, Z.GLBL_BUY_GRP_ID,\\n P.PROC_DIM_UID UNIQUE_ID, \\nP.PROC_DSPLY_ID AS DISPLAYED_ID, \\nPR.PROC_DIM_UID AS PARENT_UNIQUE_ID,\\n PR.PROC_DSPLY_ID AS PARENT_VISIBLE_ID, PR.TITLE_TXT AS PARENT_TITLE, COALESCE(P.CLNT_REF_NUM, \\'\\') AS CLIENT_REFERENCE_NUM,\\n COALESCE(R.PURCHS_ORDR_NM, \\'\\') AS PURCHASE_ORDER,\\n -- PCR_REASONS.PCR_REASON_LIST as PCR_REASON,\\n   INITWDD.WKFLW_DEF_ID, INITWDD.\"DESC\" AS INIT_WKFLW_DEF_ID_DESCR, \\n   P.TITLE_TXT PROC_TITLE, P.PROC_DESC, WKFLW.WKFLW_DEF_ID CURR_WRKFLW_NM,\\n    WKFLW_STEP.WKFLW_STEP_DEF_ID, WKFLW_STEP.WKFLW_STEP_SEQ_NUM, \\n    WKFLW_STEP.WKFLW_STEP_DESC, ST.STATE_TITLE_TXT STATE_DESC, \\n    STATUS.STAT_IBM_DESC AS STATUS_DESC, \\n    --decrypt_char(ASSGNTO.CONCAT_NM_LOGIN,MIS_REP_REF.MIS_REP_REF_CD) AS ASSIGNED_TO,\\n     AUDIENCE.ADNC_TXT AS AUDIENCE,\\n     -- P.PRIORITY_TXT, \\n     COND.COND_TXT AS CONDITION, COALESCE(RGN.REGION,GEO.KYNDRYL_RGN) REGION,\\n      ONHOLD.ON_HOLD_DESC AS HOLD_STATUS, P.ON_HOLD_DT, HOLD_RSN.ON_HOLD_RSN_TXT AS HOLD_REASON, \\n      CAST(P.ADTNL_DTLS_FOR_WITHDRW_HOLD_TXT AS VARCHAR(500)) HOLD_OR_WITHDRAW_EXPLANATION, \\n      --decrypt_char(P.RQSTR_TXT, MIS_REP_REF.MIS_REP_REF_CD) AS REQUESTOR, \\n      --decrypt_char(CREATOR.CONCAT_NM_LOGIN, MIS_REP_REF.MIS_REP_REF_CD) AS CREATED_BY,\\n      H.SRC_CRETD_TMS AS CREATED_DATE,H.SRC_UPDTD_TMS AS LAST_UPDATED, \\n      F.RQST_RCVD_DT AS RQST_RCVD_BY_IBM_DATE, \\n      F.ACKNWLDG_DT AS ACKNOWLEDGED_DATE,\\n       F.RQST_QLFYCN_DT AS RQST_QUALIFIED_DATE,\\n       F.LTTR_OF_AUTHZN_SIGNTUR_DT AS LETTER_AUTH_SIGNATURE_DT, \\n       F.PLAN_RQRD_APPRVL_DT AS PLANNED_RQMTS_APPROVAL_DATE,\\n        F.RQRD_REWORK_RQST_DT AS RQMTS_REWORK_RQSTD_DATE, \\n        F.RQRD_DEF_CMPLTD_DT AS RQMTS_DEFINITION_COMPLETE_DT, F.RQRD_AGRMT_DT AS RQMTS_AGREED_DATE,\\n         F.RQRD_REJCT_DT AS CLIENT_REJECT_RQMTS_DATE, F.PLAN_SLTN_CMPLTD_DT, F.RVSD_PLAN_SLTN_CMPLTD_DT, \\n         F.TCHNLGY_DLVR_ASSESSMT_DT, F.SLTN_CMPLTD_DT AS SOLUTION_COMPLETED_DATE, \\n         F.SLTN_APPRVL_RQRD_DT, \\n         F.CLNT_ACCPTD_SLTN_DT, \\n         F.CLNT_REJCT_SLTN_DT, F.SLTN_PKGNG_DT,\\n          F.SLTN_PKG_VALIDTD_DT AS SOLTN_PACKAGE_VALIDATE_DT, F.PRICE_CMPLTD_DT AS PRICING_COMPLETED_DT,  --  PRICING COMPLETED DATE\\n F.PRPSL_BSLN_ASSESSMT_DT,  --   PROPOSAL BASELINE ASSESSMENT \\n F.CNTRCT_BSLN_RVW_DT,  --  CONTRACT BASELINE REVIEW DATE\\n F.PRPSL_RQST_DT AS CLIENT_PRPSL_REQUESTED_DATE,  --  CLIENT PROPOSAL REQUESTED DATE\\n F.CLNT_RVSD_PRPSL_RQSTD_DT AS CLIENT_REVISED_PRPSL_REQUESTED_DATE,  --  CLIENT REVISED PROPOSAL REQUESTED DATE\\n F.PLAN_PRPSL_DT AS PLANNED_PRPSL_DATE,  --  PLANNED PROPOSAL DATE\\n F.RVSD_PLAN_PRPSL_DT AS REVISED_PLANNED_PRPSL_DATE,  --  REVISED PLANNED PROPOSAL DATE\\n F.RQST_IMPLMNT_START_DT AS  CLIENT_RQSTD_IMPL_START_DT,\\n H.DUE_DT, \\n /*DATEDIFF(day, \\'2000/01/01\\', H.DUE_DT) - DATEDIFF(day, \\'2000/01/01\\', DATEADD(hh, AF.TZ, CURRENT_TIMESTAMP)) AS DUE_IN_DAY_CNT,\\n F.PRPSL_CMPLTD_DT AS PROPOSAL_COMPLETED_DATE,  --  PROPOSAL COMPLETED DATE\\n  CASE \\n          WHEN DATEDIFF(day, \\'2000/01/01\\', ISNULL(F.PLAN_PRPSL_DT,F.RVSD_PLAN_PRPSL_DT )) - DATEDIFF(day, \\'2000/01/01\\', DATEADD(hh, AF.TZ, CURRENT_TIMESTAMP)) < 0 THEN \\'Y\\' \\n          ELSE \\'N\\' \\n     END AS OVERDUE,*/\\n F.PRPSL_APPRVL_RQRD_DT AS PROPOSAL_RESPONSE_REQUESTED_DATE,  --  PROPOSAL RESPONSE REQUESTED DATE\\n F.PRPSL_EXP_DT AS PROPOSAL_EXPIRE_DATE,  --  PROPOSAL EXPIRATION DATE\\n F.PRPSL_SENT_TO_CLNT_DT,  --  PROPOSAL SENT TO CLIENT DATE\\n F.PRPSL_ACCPTD_DT AS PROPOSAL_ACCEPTED_DATE,  --  PROPOSAL ACCEPTED DATE\\n F.PRPSL_REJCT_DT AS PROPOSAL_REJECTED_DATE,  --  PROPOSAL REJECTED DATE\\n H.CMPLTD_DT AS COMPLETION_DATE,  --  COMPLETION DATE\\n F.CLNT_SIGNTUR_RCVD_DT,  --  CLIENT SIGNATURE RECEIVED DATE\\n F.IBM_SIGNTUR_RCVD_DT,  --  IBM SIGNATURE RECEIVED DATE\\n F.RQST_IMPLMNT_CMPLTD_DT AS CLIENT_REQ_IMPLMNT_COMPLETE_DATE,  --  CLIENT REQUESTED IMPLEMENTATION COMPLETE DATE\\n F.RQST_IMPLMNT_START_DT AS CLIENT_REQ_IMPLMNT_START_DATE,  --  CLIENT REQUESTED IMPLEMENTATION START DATE\\n --decrypt_char(R.PRICER_NM, MIS_REP_REF.MIS_REP_REF_CD) AS PRICER_NM,----PRICER\\n --decrypt_char(R.PRPSL_OWNR_TXT,MIS_REP_REF.MIS_REP_REF_CD) AS PROPOSAL_OWNER, F.CLNT_RVSD_RQST_IMPL_CMPL_DT AS REVISED_CLIENT_REQ_IMPLMNT_COMPLETE_DATE,  --  CLIENT REVISED REQUESTED IMPLEMENTATION COMPLETE DATE\\n F.ENGGMT_HANDOFF_DT AS ENGAGEMENT_HANDOFF_DATE,  --  ENGAGEMENT HANDOFF DATE\\n F.PLAN_IMPLMNT_CMPLTD_DT AS PLANNED_IMPLMNT_COMPLETED_DATE,  --  PLANNED IMPLEMENTATION COMPLETED DATE\\n F.RVSD_PLN_IMPLMNT_CMPLTD_DT AS REVISED_PLANNED_IMPLMNT_COMPLETED_DATE,  --  REVISED PLANNED IMPLEMENTATION COMPLETED DATE\\n F.WITHDRWN_DT,  --  WITHDRAWN DATE\\n P.CMPLTD_RSN_TXT, R.RJCT_RSN_CD AS REJECT_REWORK_REASON,\\n  R.RJCT_SRC_CD AS REJECT_REWORK_SOURCE, R.RJCT_EXPLNN_TXT AS REJECT_REWORK_EXPLANATION, \\n  SF.LAG_DAYS_NUM, COALESCE(R.CLNT_AFFCT_AREA_TXT, \\'\\') AS CLIENT_AFFECTED_AREA, COALESCE(R.CLNT_ACCNTG_CD, \\'\\') AS CLIENT_ACCNTG_CD,\\n  -- decrypt_char(R.CLNT_CNTCT_NM, MIS_REP_REF.MIS_REP_REF_CD) AS CLIENT_CONTACT_NAME, \\n  COALESCE(R.AGRMT_REF_DTL_TXT, \\'\\') AS AGREEMENT_REF_DETAILS, COALESCE(R.ORGNTG_ORG, \\'\\') AS ORIGINATING_ORG,\\n   COALESCE(R.UNSLCTD_RQST_IND, \\'\\') AS UNSOLICITED_REQUEST, COALESCE(R.CNTRCT_CHNG_RQRD_IND, \\'\\') AS CONTRACT_CHANGE_REQUIRED,\\n    COALESCE(R.OATS_RCD_RRQRD_IND, \\'\\') AS OATS_RECORD_NEEDED, COALESCE(R.NON_STD_T_AND_C_IND, \\'\\') AS NON_STD_TERMS_CONDITIONS,\\n     COALESCE(R.TRVL_INVC_IND, \\'\\') TRAVEL_EXPENSES_INVOICED, COALESCE(R.TERMNTN_CHRGS_IND, \\'\\') AS TERMINATION_CHARGES, \\n     R.RNWL_MNTH_CD AS ANNUAL_RENEWAL_MONTH, COALESCE(R.SRVC_PRVDR_ORGNZN_TXT, \\'\\') AS SERVICE_PROVIDER_ORG,\\n      --TRIM(SUBSTRING(STYPES.SRVC_TYPE_LIST,1,300)) AS SERVICE_TYPES, COALESCE(R.RFS_GROUP_NM, \\'\\') AS REQUEST_GROUP_NAME, \\n      TRIM(SUBSTRING(R.PREDEFND_SRVCS_DESC,1,200)) AS PREDEFINED_SRVCS, GEO.SRGNCTRY_NM AS COUNTRY, \\n      COALESCE(R.SIEBEL_OPPRTNTY_NUM, \\'\\') AS SIEBEL_OPP_NUM, R.BTT_NUM, CMPLXTY.CMPLXTY_DESC AS COMPLEXITY,\\n      -- decrypt_char(R.SLTN_OWNR_TXT, MIS_REP_REF.MIS_REP_REF_CD) AS SOLUTION_OWNER,\\n      -- decrypt_char(R.DLVR_CRDNTR_TXT, MIS_REP_REF.MIS_REP_REF_CD) AS DELIVERY_COORDINATOR,\\n      -- decrypt_char(R.SLTN_DSGNR_TXT, MIS_REP_REF.MIS_REP_REF_CD) AS SOLUTION_DESIGNER,\\n       SF.ESTMTD_SLTN_HRS_NUM AS ESTIMATED_SOLUTION_HOURS, COALESCE(R.CLAIM_ACCNT_CD, \\'\\') AS CLAIM_ACCOUNT_CODE,\\n         --  CLAIM ACCOUNT CODE FOR REQUEST REPSPONSE\\n --TRIM(SUBSTRING(CL.CLAIM_WORKITEM_CODES,1,200)) AS CLAIM_WORKITEM_CODES, \\n SF.ESTMTD_IMPLMNT_HRS_NUM AS EST_IMPLEMENTATION_HOURS,\\n COALESCE(R.RSRC_SUMRY_PRSNL_INVOLV_IND, \\'\\') AS PERSONNEL_CHANGES,\\n COALESCE(R.RSRC_SUMRY_SERVER_COM_IND, \\'\\') AS SERVER_COMPONENT, COALESCE(R.RSRC_SUMRY_STRG_COM_IND, \\'\\') AS STORAGE_COMPONENT, \\n COALESCE(R.RSRC_SUMRY_HW_COM_IND, \\'\\') AS HARDWARE_COMPONENT,\\n COALESCE(R.RSRC_SUMRY_SOFTWR_COM_IND, \\'\\') AS SOFTWARE_COMPONENT, \\n CRNCY.CRNCY_NM AS LOCAL_CURRENCY, ALT_CUR.CRNCY_NM AS ALT_CURRENCY, \\n --PRICETYPE.PRICE_TYPE_LIST,  --  PRICE TYPE\\n SF.ESTMTD_OTC_AMT AS ESTIMATED_OTC_LOCAL_CURR,  --  ESTIMATED OTC IN LOCAL CURRENCY\\n SF.ESTMTD_TCV_AMT AS ESTIMATED_TCV_LOCAL_CURR,  --  ESTIMATED TCV IN LOCAL CURRENCY\\n SF.ESTMTD_PRPSL_PRDCT_COST_AMT AS ESTIMATED_PRPSL_PROD_COST_LOCAL_CURR,\\n  SF.ACTL_PRPSL_PRDCT_COST_AMT AS ACTUAL_PRPSL_PROD_COST_LOCAL_CURR, \\n  SF.NON_RECURG_COST_AMT AS NON_RECURRING_COST_LOCAL_CURR,  --  NON RECURRING COST IN LOCAL CURRENCY\\n SF.NON_RECURG_COST_ALT_CRNCY_AMT AS NON_RECURRING_COST_ALT_CURR,  --  NON RECURRING COST IN ALTERNATE CURRENCY\\n SF.MONTHLY_RECURG_COST_AMT AS MNTHLY_RECURRING_COST_LOCAL_CURR,  --  MONTHLY RECURRING COST IN LOCAL CURRENCY\\n SF.MTH_RECURG_COST_ALT_CRNCY_AMT AS MNTHLY_RECURRING_COST_ALT_CURR,  --  MONTHLY RECURRING COST IN ALTERNATE CURRENCY\\n SF.TOTAL_CNTRCT_COST_AMT AS TOTAL_CNTRCT_COST_LOCAL_CURR,  --  TOTAL CONTRACT COST IN LOCAL CURRENCY\\n SF.TOTAL_CNTRCT_COST_ALT_CRNCY_AMT AS TOTAL_CNTRCT_COST_ALT_CURR,  --  TOTAL CONTRACT COST IN ALTERNATE CURRENCY\\n SF.NON_RECURG_PRICE_AMT AS NON_RECURRING_PRICE_LOCAL_CURR,  --  NON RECURRING PRICE IN LOCAL CURRENCY\\n SF.NON_RECURG_PRCE_ALT_CRNCY_AMT AS NON_RECURRING_PRICE_ALT_CURR,  --  NON RECURRING PRICE IN ALTERNATE CURRENCY\\n SF.MONTHLY_RECURG_CHRGS_AMT AS MNTHLY_RECURRING_CHARGES_LOCAL_CURR,  --  MONTHLY RECURRING CHARGES IN LOCAL CURRENCY\\n SF.MTH_RECURG_CHRG_ALT_CRNCY_AMT AS MNTHLY_RECURRING_CHARGES_ALT_CURR, SF.TOTAL_CNTRCT_PRICE_AMT AS TOTAL_CNTRCT_PRICE_LOCAL_CURR,  --  TOTAL CONTRACT PRICE IN LOCAL CURRENCY\\n SF.TOTAL_CNTRCT_PRICE_ALT_CRNCY_AMT AS TOTAL_CNTRCT_PRICE_ALT_CURR,  --  TOTAL CONTRACT PRICE IN ALTERNATE CURRENCY\\n CLIENT_FP.USER_NAME AS CLIENT_FOCAL_POINT,  --  CLIENT FOCAL POINT\\n RFS_MGR.USER_NAME AS IBM_RFS_MANAGER,  --  IBM RFS MANAGER\\n IRTL.USER_NAME AS REQUIREMENTS_TEAM_LEAD,  --  REQUIREMENTS TEAM LEAD\\n COCR.USER_NAME AS CLIENT_CATALOG_ONLY_REQUESTOR,  --  CLIENT CATALOG ONLY REQUESTOR\\n COCA.USER_NAME AS CLIENT_CATALOG_ONLY_APPROVER,  --  CLIENT CATALOG ONLY APPROVER\\n COCBA.USER_NAME AS CLIENT_CTLG_ONLY_BUDGET_APPROVER,  --  CLIENT CATALOG ONLY BUDGET APPROVER\\n COCFP.USER_NAME AS CLIENT_CTLG_ONLY_FOCAL_POINT,  --  CLIENT CATALOG ONLY FOCAL POINT\\n SRC.SRC_SYS_CD, \\'\\' AS LEGACY_UNIQUE_ID, \\'\\' AS LEGACY_DISPLAYED_ID, TRIM(INOTES.NOTES_DESC) AS LATEST_IBM_ONLY_NOTE, TRIM(PNOTES.NOTES_DESC) AS LATEST_IBM_AND_CLIENT_NOTE, TRIM(SUBSTRING(L30_1.OFFRNG_DESC,1,80)) AS L30_OFFERING_1,  --  L30 OFFING CODE 1\\n TRIM(SUBSTRING(L30_2.OFFRNG_DESC,1,80)) AS L30_OFFERING_2,  --  L30 OFFING CODE 2\\n TRIM(SUBSTRING(L30_3.OFFRNG_DESC,1,80)) AS L30_OFFERING_3,  --  L30 OFFING CODE 3\\n SF.PRIOR_TOTAL_CNTRCT_PRICE_AMT,  --  PRIOR TOTAL CONTRACT PRICE IN LOCAL CURRENCY\\n CF.PRPSL_CHG_RSN_TXT,  --  REASON FOR PROPOSAL REQUESTED DATE CHANGE\\n CF.PRPSL_CHG_EXPLNN_TXT,  --  EXPLANATION FOR PROPOSAL REQUESTED DATE CHANGE\\n CF.IMPLMTN_CHG_RSN_TXT,  --  REASON FOR IMPLEMENTATION REQUESTED DATE CHANGE\\n CF.IMPLMTN_CHG_EXPLNN_TXT,  --  EXPLANATION FOR IMPLEMENTATION REQUESTED DATE CHANGE\\n CF.PRPSL_LATE_RSN_TXT,  --  REASON FOR MISSING THE PROPOSAL REQUESTED DATE\\n CF.PRPSL_LATE_EXPLNN_TXT,  --  EXPLANATION FOR MISSING THE PROPOSAL REQUESTED DATE\\n CF.IMPLMTN_LATE_RSN_TXT,  --  REASON FOR MISSING THE IMPLEMENTATION REQUESTED DATE\\n CF.IMPLMTN_LATE_EXPLNN_TXT,  --  EXPLANATION FOR MISSING THE IMPLEMENTATION REQUESTED DATE\\n CA.USER_NAME AS CLIENT_APPROVER, CBA.USER_NAME AS CLIENT_BUDGET_APPROVER, DATAIBM.IBM_ONLY_TEXT_1, DATAIBM.IBM_ONLY_TEXT_2, DATAIBM.IBM_ONLY_TEXT_3, DATAIBM.IBM_ONLY_TEXT_4, DATAIBM.IBM_ONLY_TEXT_5, DATAIBM.IBM_ONLY_TEXT_6, DATAIBM.IBM_ONLY_TEXT_7, DATAIBM.IBM_ONLY_TEXT_8, DATAIBM.IBM_ONLY_TEXT_9, DATAIBM.IBM_ONLY_TEXT_10, DATAIBM.IBM_ONLY_TEXT_11, DATAIBM.IBM_ONLY_TEXT_12, DATAIBM.IBM_ONLY_TEXT_13, DATAIBM.IBM_ONLY_TEXT_14, DATAIBM.IBM_ONLY_TEXT_15, DATAIBM.IBM_ONLY_TEXT_16, DATAIBM.IBM_ONLY_TEXT_17, DATAIBM.IBM_ONLY_TEXT_18, DATAIBM.IBM_ONLY_TEXT_19, DATAIBM.IBM_ONLY_TEXT_20, DATAIBM.IBM_ONLY_TEXT_21, DATAIBM.IBM_ONLY_TEXT_22, DATAIBM.IBM_ONLY_TEXT_23, DATAIBM.IBM_ONLY_TEXT_24, DATAIBM.IBM_ONLY_TEXT_25, DATAIBM.IBM_ONLY_DATE_1, DATAIBM.IBM_ONLY_DATE_2, DATAIBM.IBM_ONLY_DATE_3, DATAIBM.IBM_ONLY_DATE_4, DATAIBM.IBM_ONLY_DATE_5, DATAIBM.IBM_ONLY_DATE_6, DATAIBM.IBM_ONLY_DATE_7, DATAIBM.IBM_ONLY_DATE_8, DATAIBM.IBM_ONLY_DATE_9, DATAIBM.IBM_ONLY_DATE_10, DATAIBM.IBM_ONLY_DATE_11, DATAIBM.IBM_ONLY_DATE_12, DATAIBM.IBM_ONLY_DATE_13, DATAIBM.IBM_ONLY_DATE_14, DATAIBM.IBM_ONLY_DATE_15, DATAPBLIC.PUBLIC_TEXT_1, DATAPBLIC.PUBLIC_TEXT_2, DATAPBLIC.PUBLIC_TEXT_3, DATAPBLIC.PUBLIC_TEXT_4, DATAPBLIC.PUBLIC_TEXT_5, DATAPBLIC.PUBLIC_TEXT_6, DATAPBLIC.PUBLIC_TEXT_7, DATAPBLIC.PUBLIC_TEXT_8, DATAPBLIC.PUBLIC_TEXT_9, DATAPBLIC.PUBLIC_TEXT_10, DATAPBLIC.PUBLIC_TEXT_11, DATAPBLIC.PUBLIC_TEXT_12, DATAPBLIC.PUBLIC_TEXT_13, DATAPBLIC.PUBLIC_TEXT_14, DATAPBLIC.PUBLIC_TEXT_15, DATAPBLIC.PUBLIC_TEXT_16, DATAPBLIC.PUBLIC_TEXT_17, DATAPBLIC.PUBLIC_TEXT_18, DATAPBLIC.PUBLIC_TEXT_19, DATAPBLIC.PUBLIC_TEXT_20, DATAPBLIC.PUBLIC_TEXT_21, DATAPBLIC.PUBLIC_TEXT_22, DATAPBLIC.PUBLIC_TEXT_23, DATAPBLIC.PUBLIC_TEXT_24, DATAPBLIC.PUBLIC_TEXT_25, DATAPBLIC.PUBLIC_TEXT_26, DATAPBLIC.PUBLIC_TEXT_27, DATAPBLIC.PUBLIC_TEXT_28, DATAPBLIC.PUBLIC_TEXT_29, DATAPBLIC.PUBLIC_TEXT_30, DATAPBLIC.PUBLIC_TEXT_31, DATAPBLIC.PUBLIC_TEXT_32, DATAPBLIC.PUBLIC_TEXT_33, DATAPBLIC.PUBLIC_TEXT_34, DATAPBLIC.PUBLIC_TEXT_35, DATAPBLIC.PUBLIC_DATE_1, DATAPBLIC.PUBLIC_DATE_2, DATAPBLIC.PUBLIC_DATE_3, DATAPBLIC.PUBLIC_DATE_4, DATAPBLIC.PUBLIC_DATE_5, DATAPBLIC.PUBLIC_DATE_6, DATAPBLIC.PUBLIC_DATE_7, DATAPBLIC.PUBLIC_DATE_8, DATAPBLIC.PUBLIC_DATE_9, DATAPBLIC.PUBLIC_DATE_10, DATAPBLIC.PUBLIC_DATE_11, DATAPBLIC.PUBLIC_DATE_12, DATAPBLIC.PUBLIC_DATE_13, DATAPBLIC.PUBLIC_DATE_14, DATAPBLIC.PUBLIC_DATE_15, SOO.STAT_OF_ORGNZN_DESC AS STATE_OF_ORGANIZATION, SCTR.SCTR_NM\\n, R.ERO_CHCKD_DT, R.EA_CHCKD_DT, R.CE_CHCKD_DT, R.EXPORT_REG, R.ENVMNTL_AFF, R.CMPLNCE_ENGG, Z.CLIENT_UNIT_NM AS CLIENT_UNIT\\n\\nFROM PGMPDM.CNTRCT_DIM C\\n\\nINNER JOIN PGMPDM.PROC_DIM P ON P.CNTRCT_DIM_UID = C.CNTRCT_DIM_UID AND P.ROW_STAT_CD <> \\'D\\'\\nINNER JOIN PGMPDM.PCR_CRC_DIM R ON R.PCR_CRC_DIM_UID = P.PROC_DIM_UID AND R.ROW_STAT_CD <> \\'D\\'\\nINNER JOIN PGMPDM.PROC_HEADR_FCT H ON H.PROC_DIM_UID = P.PROC_DIM_UID AND H.ROW_STAT_CD <> \\'D\\'\\n\\nINNER JOIN PGMPDM.PCR_CRC_FCT F ON F.PROC_HEADR_FCT_UID =H.PROC_HEADR_FCT_UID AND F.ROW_STAT_CD <> \\'D\\'       \\nINNER JOIN PGMPDM.GEO_DIM GEO ON GEO.GEO_DIM_UID =H.GEO_DIM_UID \\n--AND GEO.ROW_STAT_CD <> \\'D\\'\\nINNER JOIN PGMPDM.SCTR_DIM SECTOR ON SECTOR.SCTR_DIM_UID = F.SCTR_DIM_UID AND SECTOR.ROW_STAT_CD <> \\'D\\'\\n\\nINNER JOIN PGMPDM.WKFLW_DEF_DIM WKFLW ON WKFLW.WKFLW_DEF_DIM_UID =H.WKFLW_DEF_DIM_UID AND WKFLW.ROW_STAT_CD <> \\'D\\' \\nINNER JOIN PGMPDM.WKFLW_STEP_DEF_DIM WKFLW_STEP ON WKFLW_STEP.WKFLW_STEP_DEF_DIM_UID =H.WKFLW_STEP_DEF_DIM_UID AND WKFLW_STEP.ROW_STAT_CD <> \\'D\\'    \\nINNER JOIN PGMPDM.CRNCY_DIM CRNCY ON CRNCY.CRNCY_DIM_UID = F.LOCAL_CRNCY_DIM_UID AND CRNCY.ROW_STAT_CD <> \\'D\\'\\n\\nINNER JOIN PGMPDM.CRNCY_DIM ALT_CUR ON ALT_CUR.CRNCY_DIM_UID = F.ALT_CRNCY_DIM_UID AND ALT_CUR.ROW_STAT_CD <> \\'D\\'\\nINNER JOIN PGMPDM.CMPLXTY_DIM CMPLXTY ON CMPLXTY.CMPLXTY_DIM_UID = R.CMPLXTY_DIM_UID AND CMPLXTY.ROW_STAT_CD <> \\'D\\'\\nINNER JOIN PGMPDM.RQST_TYPE_DIM RTYPE ON RTYPE.RQST_TYPE_DIM_UID = R.RQST_TYPE_DIM_UID AND RTYPE.ROW_STAT_CD <> \\'D\\'\\n\\nINNER JOIN PGMPDM.SRC_SYS_DIM SRC ON SRC.SRC_SYS_DIM_UID = R.SRC_SYS_DIM_UID AND SRC.ROW_STAT_CD <> \\'D\\'\\nINNER JOIN PGMPDM.STATE_DIM ST ON ST.STATE_DIM_UID =H.STATE_DIM_UID AND ST.ROW_STAT_CD <> \\'D\\'\\nINNER JOIN PGMPDM.PROC_STEP_DAT_DIM PSD ON P.PROC_DIM_UID = PSD.PROC_DIM_UID AND P.CURR_PROC_STEP_DAT_DIM_UID = PSD.PROC_STEP_DAT_DIM_UID AND PSD.ROW_STAT_CD <> \\'D\\'\\n\\nINNER JOIN PGMPDM.ON_HOLD_DIM ONHOLD ON ONHOLD.ON_HOLD_DIM_UID =H.ON_HOLD_DIM_UID AND ONHOLD.ROW_STAT_CD <> \\'D\\'\\nINNER JOIN PGMPDM.WINLOSS_DIM WINLOSS ON WINLOSS.WINLOSS_DIM_UID = P.WINLOSS_DIM_UID AND WINLOSS.ROW_STAT_CD <> \\'D\\'\\nINNER JOIN PGMPDM.PROC_TYPE_DIM PTYPE ON PTYPE.PROC_TYPE_DIM_UID =H.PROC_TYPE_DIM_UID AND PTYPE.ROW_STAT_CD <> \\'D\\'\\n\\nINNER JOIN PGMPDM.CNTRCT_TYPE_DIM CTYPE ON CTYPE.CNTRCT_TYPE_DIM_UID = C.CNTRCT_TYPE_DIM_UID AND CTYPE.ROW_STAT_CD <> \\'D\\'\\nINNER JOIN PGMPDM.WKFLW_DEF_DIM INITWDD ON INITWDD.WKFLW_DEF_DIM_UID =H.INIT_WKFLW_DEF_DIM_UID AND INITWDD.ROW_STAT_CD <> \\'D\\'\\nINNER JOIN PGMPDM.SCTR_DIM SCTR ON SCTR.SCTR_DIM_UID = C.SCTR_DIM_UID AND SCTR.ROW_STAT_CD <> \\'D\\'\\nLEFT OUTER JOIN PGMPDM.MISC_REP_REF MIS_REP_REF ON MIS_REP_REF_UID = 3\\n\\nLEFT OUTER JOIN PGMPDM.WITHDRWN_DIM WD ON WD.WITHDRWN_DIM_UID =H.WITHDRWN_DIM_UID AND WD.ROW_STAT_CD <> \\'D\\'\\nLEFT OUTER JOIN PGMPDM.CATLG_RQST_HEADR_DIM CTLG ON CTLG.PROC_DIM_UID = P.PROC_DIM_UID AND CTLG.ROW_STAT_CD <> \\'D\\'\\nLEFT OUTER JOIN PGMPDM.STAT_DIM STATUS ON STATUS.STAT_DIM_UID =H.STAT_DIM_UID AND STATUS.ROW_STAT_CD <> \\'D\\'\\n\\nLEFT OUTER JOIN PGMPDM.NOTES_DIM INOTES ON INOTES.PROC_DIM_UID = P.PROC_DIM_UID AND INOTES.ROW_STAT_CD <> \\'D\\' AND INOTES.NOTE_TYPE_CD = \\'I\\' AND INOTES.LATEST_NOTE_IND = \\'Y\\'\\nLEFT OUTER JOIN PGMPDM.NOTES_DIM PNOTES ON PNOTES.PROC_DIM_UID = P.PROC_DIM_UID AND PNOTES.ROW_STAT_CD <> \\'D\\' AND PNOTES.NOTE_TYPE_CD = \\'P\\' AND PNOTES.LATEST_NOTE_IND = \\'Y\\'\\nLEFT OUTER JOIN PGMPDM.ADNC_DIM AUDIENCE ON AUDIENCE.ADNC_CD = P.ADNC_CD\\n\\nLEFT OUTER JOIN PGMPDM.PRPSL_PRICE_TERM_DIM PTERM ON PTERM.PRPSL_PRICE_TERM_DIM_CD = \\'F\\' AND PTERM.ROW_STAT_CD <> \\'D\\'\\nLEFT OUTER JOIN PGMPDM.PROC_CSTM_DATA_PUBLIC_DIM PUBLIC_DATA ON PUBLIC_DATA.PROC_DIM_UID = P.PROC_DIM_UID\\nLEFT OUTER JOIN PGMPDM.PROC_CSTM_DATA_IBM_CLIENT_DIM PRIVATE_DATA ON PRIVATE_DATA.PROC_DIM_UID = P.PROC_DIM_UID\\n\\nLEFT OUTER JOIN PGMPDM.RQST_PRICE_TYPE_FCT PRICETYPFCT ON PRICETYPFCT.PROC_DIM_UID = P.PROC_DIM_UID AND PRICETYPFCT.ROW_STAT_CD <> \\'D\\'\\n--LEFT OUTER JOIN PGMPDM.PRICE_TYPES_V PRICETYPE ON PRICETYPE.PROC_DIM_UID =H.PROC_DIM_UID\\nLEFT OUTER JOIN PGMPDM.ORG_CNTRCT_MAP_DIM ORG_MAP ON ORG_MAP.CNTRCT_DIM_UID = C.CNTRCT_DIM_UID\\n\\nLEFT OUTER JOIN PGMPDM.ORGNZN_DIM ORG ON ORG.ORGNZN_DIM_UID = ORG_MAP.ORGNZN_DIM_UID\\nLEFT OUTER JOIN PGMPDM.STAT_OF_ORGNZN_DIM SOO ON SOO.STAT_OF_ORGNZN_DIM_UID = ORG.STAT_OF_ORGNZN_DIM_UID\\nLEFT OUTER JOIN PGMPDM.ON_HOLD_RSN_DIM HOLD_RSN ON HOLD_RSN.ON_HOLD_RSN_ID = P.ON_HOLD_RSN_ID\\n\\nLEFT OUTER JOIN APPFUN.PROC_REGION_V RGN ON RGN.PROC_ID =H.PROC_DIM_UID AND RGN.INTERNAL_VAL <> \\'NONE\\'\\nLEFT OUTER JOIN PGMPDM.PROC_DIM PR ON PR.PROC_DIM_UID = P.PARNT_PROC_ID AND PR.ROW_STAT_CD <> \\'D\\'\\nLEFT OUTER JOIN PGMPDM.PROC_DIM PROJECT ON PROJECT.PROC_DIM_UID = R.PRJCT_DIM_UID AND PROJECT.ROW_STAT_CD <> \\'D\\'\\n\\nLEFT OUTER JOIN PGMPDM.PROC_HEADR_FCT PRNT_HDR ON PRNT_HDR.PROC_DIM_UID = PR.PROC_DIM_UID AND PRNT_HDR.ROW_STAT_CD <> \\'D\\'\\nLEFT OUTER JOIN PGMPDM.PROC_TYPE_DIM PRNT_TYPE ON PRNT_TYPE.PROC_TYPE_DIM_UID = PRNT_HDR.PROC_TYPE_DIM_UID AND PRNT_TYPE.ROW_STAT_CD <> \\'D\\'\\n--LEFT OUTER JOIN PGMPDM.PCR_REASONS_V PCR_REASONS ON PCR_REASONS.PROC_DIM_UID =H.PROC_DIM_UID\\n\\nLEFT OUTER JOIN PGMPDM.GEO_DIM RQST_GEO ON RQST_GEO.GEO_DIM_UID = R.GEO_DIM_UID AND RQST_GEO.ROW_STAT_CD <> \\'D\\'\\nLEFT OUTER JOIN PGMPDM.SO_NONSO_DIM IS_NONIS ON IS_NONIS.SO_NONSO_DIM_UID = C.SO_NONSO_DIM_UID AND  IS_NONIS.ROW_STAT_CD <> \\'D\\'\\nLEFT OUTER JOIN PGMPDM.USER_DIM CREATOR ON CREATOR.USER_DIM_UID =H.CRETD_BY_USER_DIM_UID AND CREATOR.ROW_STAT_CD <> \\'D\\'\\n\\nLEFT OUTER JOIN PGMPDM.USER_DIM ASSGNTO ON ASSGNTO.USER_ID = PSD.ASSGN_TO_NUM AND ASSGNTO.ROW_STAT_CD <> \\'D\\'\\nLEFT OUTER JOIN PGMPDM.PRIORITY_DIM PD ON PD.PRIORITY_NUM = P.PRIORTY_NUM\\nLEFT OUTER JOIN PGMPDM.COND_DIM COND ON COND.COND_CD = P.CNDTN_CD\\n\\n--LEFT OUTER JOIN PGMPDM.CLAIM_WORKITEM_CODES_V CL ON CL.PROC_DIM_UID = P.PROC_DIM_UID\\n--LEFT OUTER JOIN PGMPDM.SERVICE_TYPES_V STYPES ON STYPES.PROC_DIM_UID = P.PROC_DIM_UID\\nLEFT OUTER JOIN PGMPDM.L30_OFFRNG_DIM L30_1 ON L30_1.OFFRNG_ID = R.L30_OFFRNG_ID_1 AND L30_1.ROW_STAT_CD <> \\'D\\'\\n\\nLEFT OUTER JOIN PGMPDM.L30_OFFRNG_DIM L30_2 ON L30_2.OFFRNG_ID = R.L30_OFFRNG_ID_2 AND L30_2.ROW_STAT_CD <> \\'D\\'\\nLEFT OUTER JOIN PGMPDM.L30_OFFRNG_DIM L30_3 ON L30_3.OFFRNG_ID = R.L30_OFFRNG_ID_3 AND L30_3.ROW_STAT_CD <> \\'D\\'\\nLEFT OUTER JOIN PGMPDM.DATE_CHG_RSN_DIM CF ON CF.DATE_CHG_RSN_DIM_UID = P.PROC_DIM_UID AND CF.ROW_STAT_CD <> \\'D\\'\\n\\nLEFT OUTER JOIN PGMPDM.PROC_ROLE_USER RFS_MGR ON RFS_MGR.ROLE_ID = 3 AND RFS_MGR.PROC_ID = P.PROC_DIM_UID AND RFS_MGR.ROW_STAT_CD <> \\'D\\'\\nLEFT OUTER JOIN PGMPDM.PROC_ROLE_USER CLIENT_FP ON CLIENT_FP.ROLE_ID = 2 AND CLIENT_FP.PROC_ID = P.PROC_DIM_UID AND CLIENT_FP.ROW_STAT_CD <> \\'D\\'      \\nLEFT OUTER JOIN PGMPDM.PROC_ROLE_USER CA ON CA.ROLE_ID = 1 AND CA.PROC_ID = P.PROC_DIM_UID AND CA.ROW_STAT_CD <> \\'D\\'\\n\\nLEFT OUTER JOIN PGMPDM.PROC_ROLE_USER CBA ON CBA.ROLE_ID = 24 AND CBA.PROC_ID = P.PROC_DIM_UID AND CBA.ROW_STAT_CD <> \\'D\\'\\nLEFT OUTER JOIN PGMPDM.PROC_CSTM_DATA_PUBLIC_DIM DATAPBLIC ON DATAPBLIC.PROC_DIM_UID = P.PROC_DIM_UID\\nLEFT OUTER JOIN PGMPDM.PROC_CSTM_DATA_IBM_CLIENT_DIM DATAIBM ON DATAIBM.PROC_DIM_UID = P.PROC_DIM_UID\\n\\nLEFT OUTER JOIN PGMPDM.ZAUX_CNTRCT_GLBL_BUY_GRP_MAP Z ON Z.CNTRCT_DIM_UID = C.CNTRCT_DIM_UID\\n\\nLEFT OUTER JOIN ( \\nSELECT PROC_HEADR_FCT_UID AS PROC_DIM_UID, SUM(ESTMTD_PRPSL_PRDCT_COST_AMT) AS ESTMTD_PRPSL_PRDCT_COST_AMT, \\nSUM(ACTL_PRPSL_PRDCT_COST_AMT) AS ACTL_PRPSL_PRDCT_COST_AMT, SUM(NON_RECURG_COST_AMT) AS NON_RECURG_COST_AMT, \\nSUM(NON_RECURG_COST_ALT_CRNCY_AMT) AS NON_RECURG_COST_ALT_CRNCY_AMT, SUM(MONTHLY_RECURG_COST_AMT) AS MONTHLY_RECURG_COST_AMT,\\n SUM(MTH_RECURG_COST_ALT_CRNCY_AMT) AS MTH_RECURG_COST_ALT_CRNCY_AMT, SUM(TOTAL_CNTRCT_COST_AMT) AS TOTAL_CNTRCT_COST_AMT, \\n SUM(TOTAL_CNTRCT_COST_ALT_CRNCY_AMT) AS TOTAL_CNTRCT_COST_ALT_CRNCY_AMT, SUM(NON_RECURG_PRICE_AMT) AS NON_RECURG_PRICE_AMT, \\n SUM(NON_RECURG_PRCE_ALT_CRNCY_AMT) AS NON_RECURG_PRCE_ALT_CRNCY_AMT, SUM(MONTHLY_RECURG_CHRGS_AMT) AS MONTHLY_RECURG_CHRGS_AMT, \\n SUM(MTH_RECURG_CHRG_ALT_CRNCY_AMT) AS MTH_RECURG_CHRG_ALT_CRNCY_AMT, SUM(TOTAL_CNTRCT_PRICE_AMT) AS TOTAL_CNTRCT_PRICE_AMT,\\n SUM(TOTAL_CNTRCT_PRICE_ALT_CRNCY_AMT) AS TOTAL_CNTRCT_PRICE_ALT_CRNCY_AMT, SUM(ESTMTD_OTC_AMT) AS ESTMTD_OTC_AMT,\\n SUM(ESTMTD_TCV_AMT) AS ESTMTD_TCV_AMT, SUM(ESTMTD_SLTN_HRS_NUM) AS ESTMTD_SLTN_HRS_NUM, SUM(ESTMTD_IMPLMNT_HRS_NUM) AS ESTMTD_IMPLMNT_HRS_NUM, \\n SUM(PRIOR_TOTAL_CNTRCT_PRICE_AMT) AS PRIOR_TOTAL_CNTRCT_PRICE_AMT, SUM(LAG_DAYS_NUM) AS LAG_DAYS_NUM \\n FROM PGMPDM.PCR_CRC_FCT FCT GROUP BY FCT.PROC_HEADR_FCT_UID )  AS SF ON SF.PROC_DIM_UID =H.PROC_DIM_UID\\n\\nLEFT OUTER JOIN PGMPDM.PROC_ROLE_USER IRTL ON IRTL.ROLE_ID = 30 AND IRTL.PROC_ID = SF.PROC_DIM_UID AND IRTL.ROW_STAT_CD <> \\'D\\'\\nLEFT OUTER JOIN PGMPDM.PROC_ROLE_USER COCR ON COCR.ROLE_ID = 26 AND COCR.PROC_ID = SF.PROC_DIM_UID AND COCR.ROW_STAT_CD <> \\'D\\'\\nLEFT OUTER JOIN PGMPDM.PROC_ROLE_USER COCA ON COCA.ROLE_ID = 27 AND COCA.PROC_ID = SF.PROC_DIM_UID AND COCA.ROW_STAT_CD <> \\'D\\'\\n\\nLEFT OUTER JOIN PGMPDM.PROC_ROLE_USER COCBA ON COCBA.ROLE_ID = 29 AND COCBA.PROC_ID = SF.PROC_DIM_UID AND COCBA.ROW_STAT_CD <> \\'D\\'\\nLEFT OUTER JOIN PGMPDM.PROC_ROLE_USER COCFP ON COCFP.ROLE_ID = 28 AND COCFP.PROC_ID = SF.PROC_DIM_UID AND COCFP.ROW_STAT_CD <> \\'D\\'\\n--LEFT OUTER JOIN PGMPDM.CNTRCT_TZ_V AF ON C.CNTRCT_DIM_UID = AF.CNTRCT_DIM_UID WHERE C.ROW_STAT_CD <> \\'D\\' \\nAND H.DELD_DT IS NULL AND SRC.SRC_SYS_CD = \\'PGMP\\'',",
				"     isolationLevel: 'READ_UNCOMMITTED') ~> getSourceDataforPCR",
				"getSourceDataforPCR alterRow(upsertIf(true())) ~> upsertRows",
				"upsertRows sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     format: 'table',",
				"     store: 'sqlserver',",
				"     schemaName: 'PGMPDM',",
				"     tableName: 'PCR_RPT',",
				"     insertable: false,",
				"     updateable: false,",
				"     deletable: false,",
				"     upsertable: true,",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError',",
				"     preCommands: [],",
				"     postCommands: []) ~> upsertTable"
			]
		}
	}
}