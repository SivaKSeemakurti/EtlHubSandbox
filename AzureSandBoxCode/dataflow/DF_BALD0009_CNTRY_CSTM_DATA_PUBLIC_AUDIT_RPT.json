{
	"name": "DF_BALD0009_CNTRY_CSTM_DATA_PUBLIC_AUDIT_RPT",
	"properties": {
		"description": "Job Creation: 14-06-2022\nJob Name: DF_BALD0009_CNTRY_CSTM_DATA_PUBLIC_AUDIT_RPT\nCreated By: Subramanian R",
		"folder": {
			"name": "PGMP/CP Summary & Custom Field audit"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"linkedService": {
						"referenceName": "ls_pgmp_rfs_db",
						"type": "LinkedServiceReference"
					},
					"name": "getSourceData"
				}
			],
			"sinks": [
				{
					"linkedService": {
						"referenceName": "ls_pgmp_rfs_db",
						"type": "LinkedServiceReference"
					},
					"name": "upsertTable"
				}
			],
			"transformations": [
				{
					"name": "sortedSourceData"
				},
				{
					"name": "upsertRows"
				}
			],
			"scriptLines": [
				"source(output(",
				"          PROC_DIM_UID as integer,",
				"          CNTRCT_DIM_UID as integer,",
				"          CNTRCT_NM as string,",
				"          PUBLIC_CNTRY_TEXT_1 as string,",
				"          UTS_PCT1 as timestamp,",
				"          UUID_PCT1 as binary,",
				"          PUBLIC_CNTRY_TEXT_2 as string,",
				"          UTS_PCT2 as timestamp,",
				"          UUID_PCT2 as binary,",
				"          PUBLIC_CNTRY_TEXT_3 as string,",
				"          UTS_PCT3 as timestamp,",
				"          UUID_PCT3 as binary,",
				"          PUBLIC_CNTRY_TEXT_4 as string,",
				"          UTS_PCT4 as timestamp,",
				"          UUID_PCT4 as binary,",
				"          PUBLIC_CNTRY_TEXT_5 as string,",
				"          UTS_PCT5 as timestamp,",
				"          UUID_PCT5 as binary,",
				"          PUBLIC_CNTRY_TEXT_6 as string,",
				"          UTS_PCT6 as timestamp,",
				"          UUID_PCT6 as binary,",
				"          PUBLIC_CNTRY_TEXT_7 as string,",
				"          UTS_PCT7 as timestamp,",
				"          UUID_PCT7 as binary,",
				"          PUBLIC_CNTRY_TEXT_8 as string,",
				"          UTS_PCT8 as timestamp,",
				"          UUID_PCT8 as binary,",
				"          PUBLIC_CNTRY_TEXT_9 as string,",
				"          UTS_PCT9 as timestamp,",
				"          UUID_PCT9 as binary,",
				"          PUBLIC_CNTRY_TEXT_10 as string,",
				"          UTS_PCT10 as timestamp,",
				"          UUID_PCT10 as binary,",
				"          PUBLIC_CNTRY_DATE_1 as date,",
				"          UTS_PCD1 as timestamp,",
				"          UUID_PCD1 as binary,",
				"          PUBLIC_CNTRY_DATE_2 as date,",
				"          UTS_PCD2 as timestamp,",
				"          UUID_PCD2 as binary,",
				"          PUBLIC_CNTRY_DATE_3 as date,",
				"          UTS_PCD3 as timestamp,",
				"          UUID_PCD3 as binary,",
				"          PUBLIC_CNTRY_DATE_4 as date,",
				"          UTS_PCD4 as timestamp,",
				"          UUID_PCD4 as binary,",
				"          PUBLIC_CNTRY_DATE_5 as date,",
				"          UTS_PCD5 as timestamp,",
				"          UUID_PCD5 as binary,",
				"          PUBLIC_CNTRY_DATE_6 as date,",
				"          UTS_PCD6 as timestamp,",
				"          UUID_PCD6 as binary,",
				"          PUBLIC_CNTRY_DATE_7 as date,",
				"          UTS_PCD7 as timestamp,",
				"          UUID_PCD7 as binary,",
				"          PUBLIC_CNTRY_DATE_8 as date,",
				"          UTS_PCD8 as timestamp,",
				"          UUID_PCD8 as binary,",
				"          PUBLIC_CNTRY_DATE_9 as date,",
				"          UTS_PCD9 as timestamp,",
				"          UUID_PCD9 as binary,",
				"          PUBLIC_CNTRY_DATE_10 as date,",
				"          UTS_PCD10 as timestamp,",
				"          UUID_PCD10 as binary",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     format: 'query',",
				"     store: 'sqlserver',",
				"     query: 'Select distinct\\n     PROCS.PROC_DIM_UID,\\n     C.CNTRCT_DIM_UID,\\n     C.CNTRCT_NM,\\n    PUBLIC_CNTRY_TEXT_1.PUBLIC_CNTRY_TEXT_1,\\n     PUBLIC_CNTRY_TEXT_1.UPDATED_TIMESTAMP AS UTS_PCT1,\\n     PUBLIC_CNTRY_TEXT_1.USER_ID AS UUID_PCT1,\\n    PUBLIC_CNTRY_TEXT_2.PUBLIC_CNTRY_TEXT_2,\\n     PUBLIC_CNTRY_TEXT_2.UPDATED_TIMESTAMP AS UTS_PCT2,\\n     PUBLIC_CNTRY_TEXT_2.USER_ID AS UUID_PCT2,\\n    PUBLIC_CNTRY_TEXT_3.PUBLIC_CNTRY_TEXT_3,\\n     PUBLIC_CNTRY_TEXT_3.UPDATED_TIMESTAMP AS UTS_PCT3,\\n     PUBLIC_CNTRY_TEXT_3.USER_ID AS UUID_PCT3,\\n    PUBLIC_CNTRY_TEXT_4.PUBLIC_CNTRY_TEXT_4,\\n     PUBLIC_CNTRY_TEXT_4.UPDATED_TIMESTAMP AS UTS_PCT4,\\n     PUBLIC_CNTRY_TEXT_4.USER_ID AS UUID_PCT4,\\n    PUBLIC_CNTRY_TEXT_5.PUBLIC_CNTRY_TEXT_5,\\n     PUBLIC_CNTRY_TEXT_5.UPDATED_TIMESTAMP AS UTS_PCT5,\\n     PUBLIC_CNTRY_TEXT_5.USER_ID AS UUID_PCT5,\\n    PUBLIC_CNTRY_TEXT_6.PUBLIC_CNTRY_TEXT_6,\\n     PUBLIC_CNTRY_TEXT_6.UPDATED_TIMESTAMP AS UTS_PCT6,\\n     PUBLIC_CNTRY_TEXT_6.USER_ID AS UUID_PCT6,\\n    PUBLIC_CNTRY_TEXT_7.PUBLIC_CNTRY_TEXT_7,\\n     PUBLIC_CNTRY_TEXT_7.UPDATED_TIMESTAMP AS UTS_PCT7,\\n     PUBLIC_CNTRY_TEXT_7.USER_ID AS UUID_PCT7,\\n    PUBLIC_CNTRY_TEXT_8.PUBLIC_CNTRY_TEXT_8,\\n     PUBLIC_CNTRY_TEXT_8.UPDATED_TIMESTAMP AS UTS_PCT8,\\n     PUBLIC_CNTRY_TEXT_8.USER_ID AS UUID_PCT8,\\n    PUBLIC_CNTRY_TEXT_9.PUBLIC_CNTRY_TEXT_9,\\n     PUBLIC_CNTRY_TEXT_9.UPDATED_TIMESTAMP AS UTS_PCT9,\\n     PUBLIC_CNTRY_TEXT_9.USER_ID AS UUID_PCT9,\\n    PUBLIC_CNTRY_TEXT_10.PUBLIC_CNTRY_TEXT_10,\\n     PUBLIC_CNTRY_TEXT_10.UPDATED_TIMESTAMP AS UTS_PCT10,\\n     PUBLIC_CNTRY_TEXT_10.USER_ID AS UUID_PCT10,\\n    PUBLIC_CNTRY_DATE_1.PUBLIC_CNTRY_DATE_1,\\n     PUBLIC_CNTRY_DATE_1.UPDATED_TIMESTAMP AS UTS_PCD1,\\n     PUBLIC_CNTRY_DATE_1.USER_ID AS UUID_PCD1,\\n    PUBLIC_CNTRY_DATE_2.PUBLIC_CNTRY_DATE_2,\\n     PUBLIC_CNTRY_DATE_2.UPDATED_TIMESTAMP AS UTS_PCD2,\\n     PUBLIC_CNTRY_DATE_2.USER_ID AS UUID_PCD2,\\n    PUBLIC_CNTRY_DATE_3.PUBLIC_CNTRY_DATE_3,\\n     PUBLIC_CNTRY_DATE_3.UPDATED_TIMESTAMP AS UTS_PCD3,\\n     PUBLIC_CNTRY_DATE_3.USER_ID AS UUID_PCD3,\\n    PUBLIC_CNTRY_DATE_4.PUBLIC_CNTRY_DATE_4,\\n     PUBLIC_CNTRY_DATE_4.UPDATED_TIMESTAMP AS UTS_PCD4,\\n     PUBLIC_CNTRY_DATE_4.USER_ID AS UUID_PCD4,\\n    PUBLIC_CNTRY_DATE_5.PUBLIC_CNTRY_DATE_5,\\n     PUBLIC_CNTRY_DATE_5.UPDATED_TIMESTAMP AS UTS_PCD5,\\n     PUBLIC_CNTRY_DATE_5.USER_ID AS UUID_PCD5,\\n    PUBLIC_CNTRY_DATE_6.PUBLIC_CNTRY_DATE_6,\\n     PUBLIC_CNTRY_DATE_6.UPDATED_TIMESTAMP AS UTS_PCD6,\\n     PUBLIC_CNTRY_DATE_6.USER_ID AS UUID_PCD6,\\n    PUBLIC_CNTRY_DATE_7.PUBLIC_CNTRY_DATE_7,\\n     PUBLIC_CNTRY_DATE_7.UPDATED_TIMESTAMP AS UTS_PCD7,\\n     PUBLIC_CNTRY_DATE_7.USER_ID AS UUID_PCD7,\\n    PUBLIC_CNTRY_DATE_8.PUBLIC_CNTRY_DATE_8,\\n     PUBLIC_CNTRY_DATE_8.UPDATED_TIMESTAMP AS UTS_PCD8,\\n     PUBLIC_CNTRY_DATE_8.USER_ID AS UUID_PCD8,\\n    PUBLIC_CNTRY_DATE_9.PUBLIC_CNTRY_DATE_9,\\n     PUBLIC_CNTRY_DATE_9.UPDATED_TIMESTAMP AS UTS_PCD9,\\n     PUBLIC_CNTRY_DATE_9.USER_ID AS UUID_PCD9,\\n    PUBLIC_CNTRY_DATE_10.PUBLIC_CNTRY_DATE_10,\\n     PUBLIC_CNTRY_DATE_10.UPDATED_TIMESTAMP AS UTS_PCD10,\\n     PUBLIC_CNTRY_DATE_10.USER_ID AS UUID_PCD10\\nFrom\\n     PGMPDM.PROC_DIM PROCS\\n     INNER JOIN PGMPDM.CNTRCT_DIM C ON C.CNTRCT_DIM_UID = PROCS.CNTRCT_DIM_UID\\n     INNER JOIN (\\n          Select distinct\\n               PROC_DIM_UID\\n          From     \\n               PGMPDM.CSTM_DATA_PUBLIC_CNTRY_DIM\\n          Where     \\n               COALESCE(\\n                    PUBLIC_CNTRY_TEXT_1,\\n                    PUBLIC_CNTRY_TEXT_2,\\n                    PUBLIC_CNTRY_TEXT_3,\\n                    PUBLIC_CNTRY_TEXT_4,\\n                    PUBLIC_CNTRY_TEXT_5,\\n                    PUBLIC_CNTRY_TEXT_6,\\n                    PUBLIC_CNTRY_TEXT_7,\\n                    PUBLIC_CNTRY_TEXT_8,\\n                    PUBLIC_CNTRY_TEXT_9,\\n                    PUBLIC_CNTRY_TEXT_10,\\n                    CAST(PUBLIC_CNTRY_DATE_1 AS VARCHAR),\\n                    CAST(PUBLIC_CNTRY_DATE_2 AS VARCHAR),\\n                    CAST(PUBLIC_CNTRY_DATE_3 AS VARCHAR),\\n                    CAST(PUBLIC_CNTRY_DATE_4 AS VARCHAR),\\n                    CAST(PUBLIC_CNTRY_DATE_5 AS VARCHAR),\\n                    CAST(PUBLIC_CNTRY_DATE_6 AS VARCHAR),\\n                    CAST(PUBLIC_CNTRY_DATE_7 AS VARCHAR),\\n                    CAST(PUBLIC_CNTRY_DATE_8 AS VARCHAR),\\n                    CAST(PUBLIC_CNTRY_DATE_9 AS VARCHAR),\\n                    CAST(PUBLIC_CNTRY_DATE_10 AS VARCHAR)\\n               ) NOT IN (\\'\\', \\'NULL\\')\\n     ) PPROC ON PPROC.PROC_DIM_UID = PROCS.PROC_DIM_UID\\n     LEFT OUTER JOIN (\\n          Select distinct\\n               DP.PROC_DIM_UID,\\n               DP.PUBLIC_CNTRY_TEXT_1 AS PUBLIC_CNTRY_TEXT_1,\\n               DPTime.UPDATED_TIMESTAMP,\\n               USER_DIM.CONCAT_NM_LOGIN AS USER_ID -- decrypt_char(USER_DIM.CONCAT_NM_LOGIN, MISC_REP_REF.MIS_REP_REF_CD) AS USER_ID\\n          From\\n               PGMPDM.CSTM_DATA_PUBLIC_CNTRY_DIM DP\\n               INNER JOIN (\\n                    Select distinct\\n                         PROC_ID,\\n                         PUBLIC_CNTRY_TEXT_1,\\n                         MIN(UPDATED_TS) AS UPDATED_TIMESTAMP\\n                    From\\n                         APPFUN.CSTM_DATA_PUBLIC_CNTRY_H\\n                    Group By\\n                         PROC_ID, \\n                         PUBLIC_CNTRY_TEXT_1                         \\n               )DPTime ON (DPTime.PROC_ID = DP.PROC_DIM_UID and DPTime.PUBLIC_CNTRY_TEXT_1 = DP.PUBLIC_CNTRY_TEXT_1)\\n               LEFT OUTER JOIN PGMPDM.USER_DIM as USER_DIM ON USER_DIM.USER_ID = (\\n                    Select distinct DPUser.UPDATED_USERID \\n                    From APPFUN.CSTM_DATA_PUBLIC_CNTRY_H DPUser\\n                    Where (DPUser.PROC_ID = DPTime.PROC_ID and DPUser.UPDATED_TS = DPTime.UPDATED_TIMESTAMP))\\n               LEFT OUTER JOIN PGMPDM.MISC_REP_REF as MISC_REP_REF ON MISC_REP_REF.MIS_REP_REF_UID = 3\\n          Where \\n               DPTime.PUBLIC_CNTRY_TEXT_1 not in (\\'\\') \\n     ) PUBLIC_CNTRY_TEXT_1 ON PUBLIC_CNTRY_TEXT_1.PROC_DIM_UID = PROCS.PROC_DIM_UID\\n    LEFT OUTER JOIN (\\n          Select distinct\\n               DP.PROC_DIM_UID,\\n               DP.PUBLIC_CNTRY_TEXT_2 AS PUBLIC_CNTRY_TEXT_2,\\n               DPTime.UPDATED_TIMESTAMP,\\n               USER_DIM.CONCAT_NM_LOGIN AS USER_ID -- decrypt_char(USER_DIM.CONCAT_NM_LOGIN, MISC_REP_REF.MIS_REP_REF_CD) AS USER_ID\\n          From\\n               PGMPDM.CSTM_DATA_PUBLIC_CNTRY_DIM DP\\n               INNER JOIN (\\n                    Select distinct\\n                         PROC_ID,\\n                         PUBLIC_CNTRY_TEXT_2,\\n                         MIN(UPDATED_TS) AS UPDATED_TIMESTAMP\\n                    From\\n                         APPFUN.CSTM_DATA_PUBLIC_CNTRY_H\\n                    Group By\\n                         PROC_ID, \\n                         PUBLIC_CNTRY_TEXT_2                    \\n               )DPTime ON (DPTime.PROC_ID = DP.PROC_DIM_UID and DPTime.PUBLIC_CNTRY_TEXT_2 = DP.PUBLIC_CNTRY_TEXT_2)\\n               LEFT OUTER JOIN PGMPDM.USER_DIM as USER_DIM ON USER_DIM.USER_ID = (\\n                    Select distinct DPUser.UPDATED_USERID \\n                    From APPFUN.CSTM_DATA_PUBLIC_CNTRY_H DPUser\\n                    Where (DPUser.PROC_ID = DPTime.PROC_ID and DPUser.UPDATED_TS = DPTime.UPDATED_TIMESTAMP))\\n               LEFT OUTER JOIN PGMPDM.MISC_REP_REF as MISC_REP_REF ON MISC_REP_REF.MIS_REP_REF_UID = 3\\n          Where \\n               DPTime.PUBLIC_CNTRY_TEXT_2 not in (\\'\\') \\n     ) PUBLIC_CNTRY_TEXT_2 ON PUBLIC_CNTRY_TEXT_2.PROC_DIM_UID = PROCS.PROC_DIM_UID\\n    LEFT OUTER JOIN (\\n          Select distinct\\n               DP.PROC_DIM_UID,\\n               DP.PUBLIC_CNTRY_TEXT_3 AS PUBLIC_CNTRY_TEXT_3,\\n               DPTime.UPDATED_TIMESTAMP,\\n               USER_DIM.CONCAT_NM_LOGIN AS USER_ID -- decrypt_char(USER_DIM.CONCAT_NM_LOGIN, MISC_REP_REF.MIS_REP_REF_CD) AS USER_ID\\n          From\\n               PGMPDM.CSTM_DATA_PUBLIC_CNTRY_DIM DP\\n               INNER JOIN (\\n                    Select distinct\\n                         PROC_ID,\\n                         PUBLIC_CNTRY_TEXT_3,\\n                         MIN(UPDATED_TS) AS UPDATED_TIMESTAMP\\n                    From\\n                         APPFUN.CSTM_DATA_PUBLIC_CNTRY_H\\n                    Group By\\n                         PROC_ID, \\n                         PUBLIC_CNTRY_TEXT_3                    \\n               )DPTime ON (DPTime.PROC_ID = DP.PROC_DIM_UID and DPTime.PUBLIC_CNTRY_TEXT_3 = DP.PUBLIC_CNTRY_TEXT_3)\\n               LEFT OUTER JOIN PGMPDM.USER_DIM as USER_DIM ON USER_DIM.USER_ID = (\\n                    Select distinct DPUser.UPDATED_USERID \\n                    From APPFUN.CSTM_DATA_PUBLIC_CNTRY_H DPUser\\n                    Where (DPUser.PROC_ID = DPTime.PROC_ID and DPUser.UPDATED_TS = DPTime.UPDATED_TIMESTAMP))\\n               LEFT OUTER JOIN PGMPDM.MISC_REP_REF as MISC_REP_REF ON MISC_REP_REF.MIS_REP_REF_UID = 3\\n          Where \\n               DPTime.PUBLIC_CNTRY_TEXT_3 not in (\\'\\') \\n     ) PUBLIC_CNTRY_TEXT_3 ON PUBLIC_CNTRY_TEXT_3.PROC_DIM_UID = PROCS.PROC_DIM_UID\\n    LEFT OUTER JOIN (\\n          Select distinct\\n               DP.PROC_DIM_UID,\\n               DP.PUBLIC_CNTRY_TEXT_4 AS PUBLIC_CNTRY_TEXT_4,\\n               DPTime.UPDATED_TIMESTAMP,\\n               USER_DIM.CONCAT_NM_LOGIN AS USER_ID -- decrypt_char(USER_DIM.CONCAT_NM_LOGIN, MISC_REP_REF.MIS_REP_REF_CD) AS USER_ID\\n          From\\n               PGMPDM.CSTM_DATA_PUBLIC_CNTRY_DIM DP\\n               INNER JOIN (\\n                    Select distinct\\n                         PROC_ID,\\n                         PUBLIC_CNTRY_TEXT_4,\\n                         MIN(UPDATED_TS) AS UPDATED_TIMESTAMP               \\n                    From\\n                         APPFUN.CSTM_DATA_PUBLIC_CNTRY_H\\n                    Group By\\n                         PROC_ID, \\n                         PUBLIC_CNTRY_TEXT_4                              \\n               )DPTime ON (DPTime.PROC_ID = DP.PROC_DIM_UID and DPTime.PUBLIC_CNTRY_TEXT_4 = DP.PUBLIC_CNTRY_TEXT_4)\\n               LEFT OUTER JOIN PGMPDM.USER_DIM as USER_DIM ON USER_DIM.USER_ID = (\\n                    Select distinct DPUser.UPDATED_USERID \\n                    From APPFUN.CSTM_DATA_PUBLIC_CNTRY_H DPUser\\n                    Where (DPUser.PROC_ID = DPTime.PROC_ID and DPUser.UPDATED_TS = DPTime.UPDATED_TIMESTAMP))\\n               LEFT OUTER JOIN PGMPDM.MISC_REP_REF as MISC_REP_REF ON MISC_REP_REF.MIS_REP_REF_UID = 3\\n          Where \\n               DPTime.PUBLIC_CNTRY_TEXT_4 not in (\\'\\') \\n     ) PUBLIC_CNTRY_TEXT_4 ON PUBLIC_CNTRY_TEXT_4.PROC_DIM_UID = PROCS.PROC_DIM_UID\\n    LEFT OUTER JOIN (\\n          Select distinct\\n               DP.PROC_DIM_UID,\\n               DP.PUBLIC_CNTRY_TEXT_5 AS PUBLIC_CNTRY_TEXT_5,\\n               DPTime.UPDATED_TIMESTAMP,\\n               USER_DIM.CONCAT_NM_LOGIN AS USER_ID -- decrypt_char(USER_DIM.CONCAT_NM_LOGIN, MISC_REP_REF.MIS_REP_REF_CD) AS USER_ID\\n          From\\n               PGMPDM.CSTM_DATA_PUBLIC_CNTRY_DIM DP\\n               INNER JOIN (\\n                    Select distinct\\n                         PROC_ID,\\n                         PUBLIC_CNTRY_TEXT_5,\\n                         MIN(UPDATED_TS) AS UPDATED_TIMESTAMP\\n                    From\\n                         APPFUN.CSTM_DATA_PUBLIC_CNTRY_H\\n                    Group By\\n                         PROC_ID, \\n                         PUBLIC_CNTRY_TEXT_5               \\n               )DPTime ON (DPTime.PROC_ID = DP.PROC_DIM_UID and DPTime.PUBLIC_CNTRY_TEXT_5 = DP.PUBLIC_CNTRY_TEXT_5)\\n               LEFT OUTER JOIN PGMPDM.USER_DIM as USER_DIM ON USER_DIM.USER_ID = (\\n                    Select distinct DPUser.UPDATED_USERID \\n                    From APPFUN.CSTM_DATA_PUBLIC_CNTRY_H DPUser\\n                    Where (DPUser.PROC_ID = DPTime.PROC_ID and DPUser.UPDATED_TS = DPTime.UPDATED_TIMESTAMP))\\n               LEFT OUTER JOIN PGMPDM.MISC_REP_REF as MISC_REP_REF ON MISC_REP_REF.MIS_REP_REF_UID = 3\\n          Where \\n               DPTime.PUBLIC_CNTRY_TEXT_5 not in (\\'\\') \\n     ) PUBLIC_CNTRY_TEXT_5 ON PUBLIC_CNTRY_TEXT_5.PROC_DIM_UID = PROCS.PROC_DIM_UID\\n    LEFT OUTER JOIN (\\n          Select distinct\\n               DP.PROC_DIM_UID,\\n               DP.PUBLIC_CNTRY_TEXT_6 AS PUBLIC_CNTRY_TEXT_6,\\n               DPTime.UPDATED_TIMESTAMP,\\n               USER_DIM.CONCAT_NM_LOGIN AS USER_ID -- decrypt_char(USER_DIM.CONCAT_NM_LOGIN, MISC_REP_REF.MIS_REP_REF_CD) AS USER_ID\\n          From\\n               PGMPDM.CSTM_DATA_PUBLIC_CNTRY_DIM DP\\n               INNER JOIN (\\n                    Select distinct\\n                         PROC_ID,\\n                         PUBLIC_CNTRY_TEXT_6,\\n                         MIN(UPDATED_TS) AS UPDATED_TIMESTAMP\\n                    From\\n                         APPFUN.CSTM_DATA_PUBLIC_CNTRY_H\\n                    Group By\\n                         PROC_ID, \\n                         PUBLIC_CNTRY_TEXT_6                    \\n               )DPTime ON (DPTime.PROC_ID = DP.PROC_DIM_UID and DPTime.PUBLIC_CNTRY_TEXT_6 = DP.PUBLIC_CNTRY_TEXT_6)\\n               LEFT OUTER JOIN PGMPDM.USER_DIM as USER_DIM ON USER_DIM.USER_ID = (\\n                    Select distinct DPUser.UPDATED_USERID \\n                    From APPFUN.CSTM_DATA_PUBLIC_CNTRY_H DPUser\\n                    Where (DPUser.PROC_ID = DPTime.PROC_ID and DPUser.UPDATED_TS = DPTime.UPDATED_TIMESTAMP))\\n               LEFT OUTER JOIN PGMPDM.MISC_REP_REF as MISC_REP_REF ON MISC_REP_REF.MIS_REP_REF_UID = 3\\n          Where \\n               DPTime.PUBLIC_CNTRY_TEXT_6 not in (\\'\\') \\n     ) PUBLIC_CNTRY_TEXT_6 ON PUBLIC_CNTRY_TEXT_6.PROC_DIM_UID = PROCS.PROC_DIM_UID\\n    LEFT OUTER JOIN (\\n          Select distinct\\n               DP.PROC_DIM_UID,\\n               DP.PUBLIC_CNTRY_TEXT_7 AS PUBLIC_CNTRY_TEXT_7,\\n               DPTime.UPDATED_TIMESTAMP,\\n               USER_DIM.CONCAT_NM_LOGIN AS USER_ID -- decrypt_char(USER_DIM.CONCAT_NM_LOGIN, MISC_REP_REF.MIS_REP_REF_CD) AS USER_ID\\n          From\\n               PGMPDM.CSTM_DATA_PUBLIC_CNTRY_DIM DP\\n               INNER JOIN (\\n                    Select distinct\\n                         PROC_ID,\\n                         PUBLIC_CNTRY_TEXT_7,\\n                         MIN(UPDATED_TS) AS UPDATED_TIMESTAMP\\n                    From\\n                         APPFUN.CSTM_DATA_PUBLIC_CNTRY_H\\n                    Group By\\n                         PROC_ID, \\n                         PUBLIC_CNTRY_TEXT_7                    \\n               )DPTime ON (DPTime.PROC_ID = DP.PROC_DIM_UID and DPTime.PUBLIC_CNTRY_TEXT_7 = DP.PUBLIC_CNTRY_TEXT_7)\\n               LEFT OUTER JOIN PGMPDM.USER_DIM as USER_DIM ON USER_DIM.USER_ID = (\\n                    Select distinct DPUser.UPDATED_USERID \\n                    From APPFUN.CSTM_DATA_PUBLIC_CNTRY_H DPUser\\n                    Where (DPUser.PROC_ID = DPTime.PROC_ID and DPUser.UPDATED_TS = DPTime.UPDATED_TIMESTAMP))\\n               LEFT OUTER JOIN PGMPDM.MISC_REP_REF as MISC_REP_REF ON MISC_REP_REF.MIS_REP_REF_UID = 3\\n          Where \\n               DPTime.PUBLIC_CNTRY_TEXT_7 not in (\\'\\') \\n     ) PUBLIC_CNTRY_TEXT_7 ON PUBLIC_CNTRY_TEXT_7.PROC_DIM_UID = PROCS.PROC_DIM_UID\\n    LEFT OUTER JOIN (\\n          Select distinct\\n               DP.PROC_DIM_UID,\\n               DP.PUBLIC_CNTRY_TEXT_8 AS PUBLIC_CNTRY_TEXT_8,\\n               DPTime.UPDATED_TIMESTAMP,\\n               USER_DIM.CONCAT_NM_LOGIN AS USER_ID -- decrypt_char(USER_DIM.CONCAT_NM_LOGIN, MISC_REP_REF.MIS_REP_REF_CD) AS USER_ID\\n          From\\n               PGMPDM.CSTM_DATA_PUBLIC_CNTRY_DIM DP\\n               INNER JOIN (\\n                    Select distinct\\n                         PROC_ID,\\n                         PUBLIC_CNTRY_TEXT_8,\\n                         MIN(UPDATED_TS) AS UPDATED_TIMESTAMP\\n                    From\\n                         APPFUN.CSTM_DATA_PUBLIC_CNTRY_H\\n                    Group By\\n                         PROC_ID, \\n                         PUBLIC_CNTRY_TEXT_8                    \\n               )DPTime ON (DPTime.PROC_ID = DP.PROC_DIM_UID and DPTime.PUBLIC_CNTRY_TEXT_8 = DP.PUBLIC_CNTRY_TEXT_8)\\n               LEFT OUTER JOIN PGMPDM.USER_DIM as USER_DIM ON USER_DIM.USER_ID = (\\n                    Select distinct DPUser.UPDATED_USERID \\n                    From APPFUN.CSTM_DATA_PUBLIC_CNTRY_H DPUser\\n                    Where (DPUser.PROC_ID = DPTime.PROC_ID and DPUser.UPDATED_TS = DPTime.UPDATED_TIMESTAMP))\\n               LEFT OUTER JOIN PGMPDM.MISC_REP_REF as MISC_REP_REF ON MISC_REP_REF.MIS_REP_REF_UID = 3\\n          Where \\n               DPTime.PUBLIC_CNTRY_TEXT_8 not in (\\'\\') \\n     ) PUBLIC_CNTRY_TEXT_8 ON PUBLIC_CNTRY_TEXT_8.PROC_DIM_UID = PROCS.PROC_DIM_UID\\n    LEFT OUTER JOIN (\\n          Select distinct\\n               DP.PROC_DIM_UID,\\n               DP.PUBLIC_CNTRY_TEXT_9 AS PUBLIC_CNTRY_TEXT_9,\\n               DPTime.UPDATED_TIMESTAMP,\\n               USER_DIM.CONCAT_NM_LOGIN AS USER_ID -- decrypt_char(USER_DIM.CONCAT_NM_LOGIN, MISC_REP_REF.MIS_REP_REF_CD) AS USER_ID\\n          From\\n               PGMPDM.CSTM_DATA_PUBLIC_CNTRY_DIM DP\\n               INNER JOIN (\\n                    Select distinct\\n                         PROC_ID,\\n                         PUBLIC_CNTRY_TEXT_9,\\n                         MIN(UPDATED_TS) AS UPDATED_TIMESTAMP\\n                    From\\n                         APPFUN.CSTM_DATA_PUBLIC_CNTRY_H\\n                    Group By\\n                         PROC_ID, \\n                         PUBLIC_CNTRY_TEXT_9                    \\n               )DPTime ON (DPTime.PROC_ID = DP.PROC_DIM_UID and DPTime.PUBLIC_CNTRY_TEXT_9 = DP.PUBLIC_CNTRY_TEXT_9)\\n               LEFT OUTER JOIN PGMPDM.USER_DIM as USER_DIM ON USER_DIM.USER_ID = (\\n                    Select distinct DPUser.UPDATED_USERID \\n                    From APPFUN.CSTM_DATA_PUBLIC_CNTRY_H DPUser\\n                    Where (DPUser.PROC_ID = DPTime.PROC_ID and DPUser.UPDATED_TS = DPTime.UPDATED_TIMESTAMP))\\n               LEFT OUTER JOIN PGMPDM.MISC_REP_REF as MISC_REP_REF ON MISC_REP_REF.MIS_REP_REF_UID = 3\\n          Where \\n               DPTime.PUBLIC_CNTRY_TEXT_9 not in (\\'\\') \\n     ) PUBLIC_CNTRY_TEXT_9 ON PUBLIC_CNTRY_TEXT_9.PROC_DIM_UID = PROCS.PROC_DIM_UID\\n    LEFT OUTER JOIN (\\n          Select distinct\\n               DP.PROC_DIM_UID,\\n               DP.PUBLIC_CNTRY_TEXT_10 AS PUBLIC_CNTRY_TEXT_10,\\n               DPTime.UPDATED_TIMESTAMP,\\n               USER_DIM.CONCAT_NM_LOGIN AS USER_ID -- decrypt_char(USER_DIM.CONCAT_NM_LOGIN, MISC_REP_REF.MIS_REP_REF_CD) AS USER_ID\\n          From\\n               PGMPDM.CSTM_DATA_PUBLIC_CNTRY_DIM DP\\n               INNER JOIN (\\n                    Select distinct\\n                         PROC_ID,\\n                         PUBLIC_CNTRY_TEXT_10,\\n                         MIN(UPDATED_TS) AS UPDATED_TIMESTAMP\\n                    From\\n                         APPFUN.CSTM_DATA_PUBLIC_CNTRY_H\\n                    Group By\\n                         PROC_ID, \\n                         PUBLIC_CNTRY_TEXT_10                    \\n               )DPTime ON (DPTime.PROC_ID = DP.PROC_DIM_UID and DPTime.PUBLIC_CNTRY_TEXT_10 = DP.PUBLIC_CNTRY_TEXT_10)\\n               LEFT OUTER JOIN PGMPDM.USER_DIM as USER_DIM ON USER_DIM.USER_ID = (\\n                    Select distinct DPUser.UPDATED_USERID \\n                    From APPFUN.CSTM_DATA_PUBLIC_CNTRY_H DPUser\\n                    Where (DPUser.PROC_ID = DPTime.PROC_ID and DPUser.UPDATED_TS = DPTime.UPDATED_TIMESTAMP))\\n               LEFT OUTER JOIN PGMPDM.MISC_REP_REF as MISC_REP_REF ON MISC_REP_REF.MIS_REP_REF_UID = 3\\n          Where \\n               DPTime.PUBLIC_CNTRY_TEXT_10 not in (\\'\\') \\n     ) PUBLIC_CNTRY_TEXT_10 ON PUBLIC_CNTRY_TEXT_10.PROC_DIM_UID = PROCS.PROC_DIM_UID\\n    LEFT OUTER JOIN (\\n          Select distinct\\n               DP.PROC_DIM_UID,\\n               DP.PUBLIC_CNTRY_DATE_1 AS PUBLIC_CNTRY_DATE_1,\\n               DPTime.UPDATED_TIMESTAMP,\\n               USER_DIM.CONCAT_NM_LOGIN AS USER_ID -- decrypt_char(USER_DIM.CONCAT_NM_LOGIN, MISC_REP_REF.MIS_REP_REF_CD) AS USER_ID\\n          From\\n               PGMPDM.CSTM_DATA_PUBLIC_CNTRY_DIM DP\\n               INNER JOIN (\\n                    Select distinct\\n                         PROC_ID,\\n                         PUBLIC_CNTRY_DATE_1,\\n                         MIN(UPDATED_TS) AS UPDATED_TIMESTAMP\\n                    From\\n                         APPFUN.CSTM_DATA_PUBLIC_CNTRY_H\\n                    Group By\\n                         PROC_ID, \\n                         PUBLIC_CNTRY_DATE_1                    \\n               )DPTime ON (DPTime.PROC_ID = DP.PROC_DIM_UID and DPTime.PUBLIC_CNTRY_DATE_1 = DP.PUBLIC_CNTRY_DATE_1)\\n               LEFT OUTER JOIN PGMPDM.USER_DIM as USER_DIM ON USER_DIM.USER_ID = (\\n                    Select distinct DPUser.UPDATED_USERID \\n                    From APPFUN.CSTM_DATA_PUBLIC_CNTRY_H DPUser\\n                    Where (DPUser.PROC_ID = DPTime.PROC_ID and DPUser.UPDATED_TS = DPTime.UPDATED_TIMESTAMP))\\n               LEFT OUTER JOIN PGMPDM.MISC_REP_REF as MISC_REP_REF ON MISC_REP_REF.MIS_REP_REF_UID = 3\\n          Where \\n               DPTime.PUBLIC_CNTRY_DATE_1 not like (\\'\\') \\n     ) PUBLIC_CNTRY_DATE_1 ON PUBLIC_CNTRY_DATE_1.PROC_DIM_UID = PROCS.PROC_DIM_UID\\n    LEFT OUTER JOIN (\\n          Select distinct\\n               DP.PROC_DIM_UID,\\n               DP.PUBLIC_CNTRY_DATE_2 AS PUBLIC_CNTRY_DATE_2,\\n               DPTime.UPDATED_TIMESTAMP,\\n               USER_DIM.CONCAT_NM_LOGIN AS USER_ID -- decrypt_char(USER_DIM.CONCAT_NM_LOGIN, MISC_REP_REF.MIS_REP_REF_CD) AS USER_ID\\n          From\\n               PGMPDM.CSTM_DATA_PUBLIC_CNTRY_DIM DP\\n               INNER JOIN (\\n                    Select distinct\\n                         PROC_ID,\\n                         PUBLIC_CNTRY_DATE_2,\\n                         MIN(UPDATED_TS) AS UPDATED_TIMESTAMP\\n                    From\\n                         APPFUN.CSTM_DATA_PUBLIC_CNTRY_H\\n                    Group By\\n                         PROC_ID, \\n                         PUBLIC_CNTRY_DATE_2                    \\n               )DPTime ON (DPTime.PROC_ID = DP.PROC_DIM_UID and DPTime.PUBLIC_CNTRY_DATE_2 = DP.PUBLIC_CNTRY_DATE_2)\\n               LEFT OUTER JOIN PGMPDM.USER_DIM as USER_DIM ON USER_DIM.USER_ID = (\\n                    Select distinct DPUser.UPDATED_USERID \\n                    From APPFUN.CSTM_DATA_PUBLIC_CNTRY_H DPUser\\n                    Where (DPUser.PROC_ID = DPTime.PROC_ID and DPUser.UPDATED_TS = DPTime.UPDATED_TIMESTAMP))\\n               LEFT OUTER JOIN PGMPDM.MISC_REP_REF as MISC_REP_REF ON MISC_REP_REF.MIS_REP_REF_UID = 3\\n          Where \\n               DPTime.PUBLIC_CNTRY_DATE_2 not like (\\'\\') \\n     ) PUBLIC_CNTRY_DATE_2 ON PUBLIC_CNTRY_DATE_2.PROC_DIM_UID = PROCS.PROC_DIM_UID\\n    LEFT OUTER JOIN (\\n          Select distinct\\n               DP.PROC_DIM_UID,\\n               DP.PUBLIC_CNTRY_DATE_3 AS PUBLIC_CNTRY_DATE_3,\\n               DPTime.UPDATED_TIMESTAMP,\\n               USER_DIM.CONCAT_NM_LOGIN AS USER_ID -- decrypt_char(USER_DIM.CONCAT_NM_LOGIN, MISC_REP_REF.MIS_REP_REF_CD) AS USER_ID\\n          From\\n               PGMPDM.CSTM_DATA_PUBLIC_CNTRY_DIM DP\\n               INNER JOIN (\\n                    Select distinct\\n                         PROC_ID,\\n                         PUBLIC_CNTRY_DATE_3,\\n                         MIN(UPDATED_TS) AS UPDATED_TIMESTAMP\\n                    From\\n                         APPFUN.CSTM_DATA_PUBLIC_CNTRY_H\\n                    Group By\\n                         PROC_ID, \\n                         PUBLIC_CNTRY_DATE_3                    \\n               )DPTime ON (DPTime.PROC_ID = DP.PROC_DIM_UID and DPTime.PUBLIC_CNTRY_DATE_3 = DP.PUBLIC_CNTRY_DATE_3)\\n               LEFT OUTER JOIN PGMPDM.USER_DIM as USER_DIM ON USER_DIM.USER_ID = (\\n                    Select distinct DPUser.UPDATED_USERID \\n                    From APPFUN.CSTM_DATA_PUBLIC_CNTRY_H DPUser\\n                    Where (DPUser.PROC_ID = DPTime.PROC_ID and DPUser.UPDATED_TS = DPTime.UPDATED_TIMESTAMP))\\n               LEFT OUTER JOIN PGMPDM.MISC_REP_REF as MISC_REP_REF ON MISC_REP_REF.MIS_REP_REF_UID = 3\\n          Where \\n               DPTime.PUBLIC_CNTRY_DATE_3 not like (\\'\\') \\n     ) PUBLIC_CNTRY_DATE_3 ON PUBLIC_CNTRY_DATE_3.PROC_DIM_UID = PROCS.PROC_DIM_UID\\n    LEFT OUTER JOIN (\\n          Select distinct\\n               DP.PROC_DIM_UID,\\n               DP.PUBLIC_CNTRY_DATE_4 AS PUBLIC_CNTRY_DATE_4,\\n               DPTime.UPDATED_TIMESTAMP,\\n               USER_DIM.CONCAT_NM_LOGIN AS USER_ID -- decrypt_char(USER_DIM.CONCAT_NM_LOGIN, MISC_REP_REF.MIS_REP_REF_CD) AS USER_ID\\n          From\\n               PGMPDM.CSTM_DATA_PUBLIC_CNTRY_DIM DP\\n               INNER JOIN (\\n                    Select distinct\\n                         PROC_ID,\\n                         PUBLIC_CNTRY_DATE_4,\\n                         MIN(UPDATED_TS) AS UPDATED_TIMESTAMP     \\n                    From\\n                         APPFUN.CSTM_DATA_PUBLIC_CNTRY_H\\n                    Group By\\n                         PROC_ID, \\n                         PUBLIC_CNTRY_DATE_4                    \\n               )DPTime ON (DPTime.PROC_ID = DP.PROC_DIM_UID and DPTime.PUBLIC_CNTRY_DATE_4 = DP.PUBLIC_CNTRY_DATE_4)\\n               LEFT OUTER JOIN PGMPDM.USER_DIM as USER_DIM ON USER_DIM.USER_ID = (\\n                    Select distinct DPUser.UPDATED_USERID \\n                    From APPFUN.CSTM_DATA_PUBLIC_CNTRY_H DPUser\\n                    Where (DPUser.PROC_ID = DPTime.PROC_ID and DPUser.UPDATED_TS = DPTime.UPDATED_TIMESTAMP))\\n               LEFT OUTER JOIN PGMPDM.MISC_REP_REF as MISC_REP_REF ON MISC_REP_REF.MIS_REP_REF_UID = 3\\n          Where \\n               DPTime.PUBLIC_CNTRY_DATE_4 not like (\\'\\') \\n     ) PUBLIC_CNTRY_DATE_4 ON PUBLIC_CNTRY_DATE_4.PROC_DIM_UID = PROCS.PROC_DIM_UID\\n    LEFT OUTER JOIN (\\n          Select distinct\\n               DP.PROC_DIM_UID,\\n               DP.PUBLIC_CNTRY_DATE_5 AS PUBLIC_CNTRY_DATE_5,\\n               DPTime.UPDATED_TIMESTAMP,\\n               USER_DIM.CONCAT_NM_LOGIN AS USER_ID -- decrypt_char(USER_DIM.CONCAT_NM_LOGIN, MISC_REP_REF.MIS_REP_REF_CD) AS USER_ID\\n          From\\n               PGMPDM.CSTM_DATA_PUBLIC_CNTRY_DIM DP\\n               INNER JOIN (\\n                    Select distinct\\n                         PROC_ID,\\n                         PUBLIC_CNTRY_DATE_5,\\n                         MIN(UPDATED_TS) AS UPDATED_TIMESTAMP\\n                    From\\n                         APPFUN.CSTM_DATA_PUBLIC_CNTRY_H\\n                    Group By\\n                         PROC_ID, \\n                         PUBLIC_CNTRY_DATE_5                    \\n               )DPTime ON (DPTime.PROC_ID = DP.PROC_DIM_UID and DPTime.PUBLIC_CNTRY_DATE_5 = DP.PUBLIC_CNTRY_DATE_5)\\n               LEFT OUTER JOIN PGMPDM.USER_DIM as USER_DIM ON USER_DIM.USER_ID = (\\n                    Select distinct DPUser.UPDATED_USERID \\n                    From APPFUN.CSTM_DATA_PUBLIC_CNTRY_H DPUser\\n                    Where (DPUser.PROC_ID = DPTime.PROC_ID and DPUser.UPDATED_TS = DPTime.UPDATED_TIMESTAMP))\\n               LEFT OUTER JOIN PGMPDM.MISC_REP_REF as MISC_REP_REF ON MISC_REP_REF.MIS_REP_REF_UID = 3\\n          Where \\n               DPTime.PUBLIC_CNTRY_DATE_5 not like (\\'\\') \\n     ) PUBLIC_CNTRY_DATE_5 ON PUBLIC_CNTRY_DATE_5.PROC_DIM_UID = PROCS.PROC_DIM_UID\\n    LEFT OUTER JOIN (\\n          Select distinct\\n               DP.PROC_DIM_UID,\\n               DP.PUBLIC_CNTRY_DATE_6 AS PUBLIC_CNTRY_DATE_6,\\n               DPTime.UPDATED_TIMESTAMP,\\n               USER_DIM.CONCAT_NM_LOGIN AS USER_ID -- decrypt_char(USER_DIM.CONCAT_NM_LOGIN, MISC_REP_REF.MIS_REP_REF_CD) AS USER_ID\\n          From\\n               PGMPDM.CSTM_DATA_PUBLIC_CNTRY_DIM DP\\n               INNER JOIN (\\n                    Select distinct\\n                         PROC_ID,\\n                         PUBLIC_CNTRY_DATE_6,\\n                         MIN(UPDATED_TS) AS UPDATED_TIMESTAMP\\n                    From\\n                         APPFUN.CSTM_DATA_PUBLIC_CNTRY_H\\n                    Group By\\n                         PROC_ID, \\n                         PUBLIC_CNTRY_DATE_6                    \\n               )DPTime ON (DPTime.PROC_ID = DP.PROC_DIM_UID and DPTime.PUBLIC_CNTRY_DATE_6 = DP.PUBLIC_CNTRY_DATE_6)\\n               LEFT OUTER JOIN PGMPDM.USER_DIM as USER_DIM ON USER_DIM.USER_ID = (\\n                    Select distinct DPUser.UPDATED_USERID \\n                    From APPFUN.CSTM_DATA_PUBLIC_CNTRY_H DPUser\\n                    Where (DPUser.PROC_ID = DPTime.PROC_ID and DPUser.UPDATED_TS = DPTime.UPDATED_TIMESTAMP))\\n               LEFT OUTER JOIN PGMPDM.MISC_REP_REF as MISC_REP_REF ON MISC_REP_REF.MIS_REP_REF_UID = 3\\n          Where \\n               DPTime.PUBLIC_CNTRY_DATE_6 not like (\\'\\') \\n     ) PUBLIC_CNTRY_DATE_6 ON PUBLIC_CNTRY_DATE_6.PROC_DIM_UID = PROCS.PROC_DIM_UID\\n    LEFT OUTER JOIN (\\n          Select distinct\\n               DP.PROC_DIM_UID,\\n               DP.PUBLIC_CNTRY_DATE_7 AS PUBLIC_CNTRY_DATE_7,\\n               DPTime.UPDATED_TIMESTAMP,\\n               USER_DIM.CONCAT_NM_LOGIN AS USER_ID -- decrypt_char(USER_DIM.CONCAT_NM_LOGIN, MISC_REP_REF.MIS_REP_REF_CD) AS USER_ID\\n          From\\n               PGMPDM.CSTM_DATA_PUBLIC_CNTRY_DIM DP\\n               INNER JOIN (\\n                    Select distinct\\n                         PROC_ID,\\n                         PUBLIC_CNTRY_DATE_7,\\n                         MIN(UPDATED_TS) AS UPDATED_TIMESTAMP\\n                    From\\n                         APPFUN.CSTM_DATA_PUBLIC_CNTRY_H\\n                    Group By\\n                         PROC_ID, \\n                         PUBLIC_CNTRY_DATE_7                    \\n               )DPTime ON (DPTime.PROC_ID = DP.PROC_DIM_UID and DPTime.PUBLIC_CNTRY_DATE_7 = DP.PUBLIC_CNTRY_DATE_7)\\n               LEFT OUTER JOIN PGMPDM.USER_DIM as USER_DIM ON USER_DIM.USER_ID = (\\n                    Select distinct DPUser.UPDATED_USERID \\n                    From APPFUN.CSTM_DATA_PUBLIC_CNTRY_H DPUser\\n                    Where (DPUser.PROC_ID = DPTime.PROC_ID and DPUser.UPDATED_TS = DPTime.UPDATED_TIMESTAMP))\\n               LEFT OUTER JOIN PGMPDM.MISC_REP_REF as MISC_REP_REF ON MISC_REP_REF.MIS_REP_REF_UID = 3\\n          Where \\n               DPTime.PUBLIC_CNTRY_DATE_7 not like (\\'\\') \\n     ) PUBLIC_CNTRY_DATE_7 ON PUBLIC_CNTRY_DATE_7.PROC_DIM_UID = PROCS.PROC_DIM_UID\\n    LEFT OUTER JOIN (\\n          Select distinct\\n               DP.PROC_DIM_UID,\\n               DP.PUBLIC_CNTRY_DATE_8 AS PUBLIC_CNTRY_DATE_8,\\n               DPTime.UPDATED_TIMESTAMP,\\n               USER_DIM.CONCAT_NM_LOGIN AS USER_ID -- decrypt_char(USER_DIM.CONCAT_NM_LOGIN, MISC_REP_REF.MIS_REP_REF_CD) AS USER_ID\\n          From\\n               PGMPDM.CSTM_DATA_PUBLIC_CNTRY_DIM DP\\n               INNER JOIN (\\n                    Select distinct\\n                         PROC_ID,\\n                         PUBLIC_CNTRY_DATE_8,\\n                         MIN(UPDATED_TS) AS UPDATED_TIMESTAMP\\n                    From\\n                         APPFUN.CSTM_DATA_PUBLIC_CNTRY_H\\n                    Group By\\n                         PROC_ID, \\n                         PUBLIC_CNTRY_DATE_8                    \\n               )DPTime ON (DPTime.PROC_ID = DP.PROC_DIM_UID and DPTime.PUBLIC_CNTRY_DATE_8 = DP.PUBLIC_CNTRY_DATE_8)\\n               LEFT OUTER JOIN PGMPDM.USER_DIM as USER_DIM ON USER_DIM.USER_ID = (\\n                    Select distinct DPUser.UPDATED_USERID \\n                    From APPFUN.CSTM_DATA_PUBLIC_CNTRY_H DPUser\\n                    Where (DPUser.PROC_ID = DPTime.PROC_ID and DPUser.UPDATED_TS = DPTime.UPDATED_TIMESTAMP))\\n               LEFT OUTER JOIN PGMPDM.MISC_REP_REF as MISC_REP_REF ON MISC_REP_REF.MIS_REP_REF_UID = 3\\n          Where \\n               DPTime.PUBLIC_CNTRY_DATE_8 not like (\\'\\') \\n     ) PUBLIC_CNTRY_DATE_8 ON PUBLIC_CNTRY_DATE_8.PROC_DIM_UID = PROCS.PROC_DIM_UID\\n    LEFT OUTER JOIN (\\n          Select distinct\\n               DP.PROC_DIM_UID,\\n               DP.PUBLIC_CNTRY_DATE_9 AS PUBLIC_CNTRY_DATE_9,\\n               DPTime.UPDATED_TIMESTAMP,\\n               USER_DIM.CONCAT_NM_LOGIN AS USER_ID -- decrypt_char(USER_DIM.CONCAT_NM_LOGIN, MISC_REP_REF.MIS_REP_REF_CD) AS USER_ID\\n          From\\n               PGMPDM.CSTM_DATA_PUBLIC_CNTRY_DIM DP\\n               INNER JOIN (\\n                    Select distinct\\n                         PROC_ID,\\n                         PUBLIC_CNTRY_DATE_9,\\n                         MIN(UPDATED_TS) AS UPDATED_TIMESTAMP\\n                    From\\n                         APPFUN.CSTM_DATA_PUBLIC_CNTRY_H\\n                    Group By\\n                         PROC_ID, \\n                         PUBLIC_CNTRY_DATE_9                         \\n               )DPTime ON (DPTime.PROC_ID = DP.PROC_DIM_UID and DPTime.PUBLIC_CNTRY_DATE_9 = DP.PUBLIC_CNTRY_DATE_9)\\n               LEFT OUTER JOIN PGMPDM.USER_DIM as USER_DIM ON USER_DIM.USER_ID = (\\n                    Select distinct DPUser.UPDATED_USERID \\n                    From APPFUN.CSTM_DATA_PUBLIC_CNTRY_H DPUser\\n                    Where (DPUser.PROC_ID = DPTime.PROC_ID and DPUser.UPDATED_TS = DPTime.UPDATED_TIMESTAMP))\\n               LEFT OUTER JOIN PGMPDM.MISC_REP_REF as MISC_REP_REF ON MISC_REP_REF.MIS_REP_REF_UID = 3\\n          Where \\n               DPTime.PUBLIC_CNTRY_DATE_9 not like (\\'\\') \\n     ) PUBLIC_CNTRY_DATE_9 ON PUBLIC_CNTRY_DATE_9.PROC_DIM_UID = PROCS.PROC_DIM_UID\\n    LEFT OUTER JOIN (\\n          Select distinct\\n               DP.PROC_DIM_UID,\\n               DP.PUBLIC_CNTRY_DATE_10 AS PUBLIC_CNTRY_DATE_10,\\n               DPTime.UPDATED_TIMESTAMP,\\n               USER_DIM.CONCAT_NM_LOGIN AS USER_ID -- decrypt_char(USER_DIM.CONCAT_NM_LOGIN, MISC_REP_REF.MIS_REP_REF_CD) AS USER_ID\\n          From\\n               PGMPDM.CSTM_DATA_PUBLIC_CNTRY_DIM DP\\n               INNER JOIN (\\n                    Select distinct\\n                         PROC_ID,\\n                         PUBLIC_CNTRY_DATE_10,\\n                         MIN(UPDATED_TS) AS UPDATED_TIMESTAMP\\n                    From\\n                         APPFUN.CSTM_DATA_PUBLIC_CNTRY_H\\n                    Group By\\n                         PROC_ID, \\n                         PUBLIC_CNTRY_DATE_10                    \\n               )DPTime ON (DPTime.PROC_ID = DP.PROC_DIM_UID and DPTime.PUBLIC_CNTRY_DATE_10 = DP.PUBLIC_CNTRY_DATE_10)\\n               LEFT OUTER JOIN PGMPDM.USER_DIM as USER_DIM ON USER_DIM.USER_ID = (\\n                    Select distinct DPUser.UPDATED_USERID \\n                    From APPFUN.CSTM_DATA_PUBLIC_CNTRY_H DPUser\\n                    Where (DPUser.PROC_ID = DPTime.PROC_ID and DPUser.UPDATED_TS = DPTime.UPDATED_TIMESTAMP))\\n               LEFT OUTER JOIN PGMPDM.MISC_REP_REF as MISC_REP_REF ON MISC_REP_REF.MIS_REP_REF_UID = 3\\n          Where \\n               DPTime.PUBLIC_CNTRY_DATE_10 not like (\\'\\') \\n     ) PUBLIC_CNTRY_DATE_10 ON PUBLIC_CNTRY_DATE_10.PROC_DIM_UID = PROCS.PROC_DIM_UID',",
				"     isolationLevel: 'READ_UNCOMMITTED') ~> getSourceData",
				"getSourceData sort(asc(PROC_DIM_UID, false)) ~> sortedSourceData",
				"sortedSourceData alterRow(upsertIf(true())) ~> upsertRows",
				"upsertRows sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     format: 'table',",
				"     store: 'sqlserver',",
				"     schemaName: 'PGMPDM',",
				"     tableName: 'CNTRY_CSTM_DATA_PUBLIC_AUDIT_RPT',",
				"     insertable: true,",
				"     updateable: true,",
				"     deletable: false,",
				"     upsertable: false,",
				"     keys:['PROC_DIM_UID'],",
				"     skipKeyWrites:true,",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError') ~> upsertTable"
			]
		}
	}
}